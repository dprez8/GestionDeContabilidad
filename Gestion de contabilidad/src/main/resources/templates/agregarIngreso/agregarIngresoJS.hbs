const agregarIngreso = {
    template: `{{> agregarIngreso/agregarIngresoHTML.hbs}}`,
    data() {
        return {
            ingreso: {
                fechaOperacion: null,
                descripcion: null,
                montoTotal: null
            },
            falloInput: false,
            falloCargarIngreso: false,
        }
    },
    computed: {
        state(data) {
            console.log(data);
            return false;
        }
    },
    methods: {
        convertDate: convertDate,
        softReloadPage: softReloadPage,
        confirmar() {
            // Creo el ingreso
            var todosLosCamposRellenos = 
                this.ingreso.fechaOperacion                               &&
                this.ingreso.montoTotal                          

            this.falloInput = !todosLosCamposRellenos;
            if(this.falloInput) {
                return;
            }
            
            var ingresoToSend = JSON.parse(JSON.stringify(this.ingreso));

            console.log("POST '/api/operaciones/ingreso'");
            console.log(JSON.stringify(ingresoToSend, null, 4));

            $.ajax({
                url: "http://{{ ip }}/api/operaciones/ingreso",
                type: "POST",
                dataType: "json",
                context: this,
                data: JSON.stringify(ingresoToSend),
                success(response) {
                    if(response.code == 403) {
                        app.showSessionEndedAlert(false);
                    } else if(response.code == 400) {
                        this.falloCargarIngreso = true;
                    } else if(response.code == 200) {
                        this.$router.push('/operaciones/ingreso');
                    }
                    console.log(response);
                },
                complete() {
                    console.log("termino");
                }
            });

            // Obtengo la id del ingreso que se cre√≥
        },
    }
};