(function(e){function t(t){for(var a,i,n=t[0],c=t[1],l=t[2],u=0,g=[];u<n.length;u++)i=n[u],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&g.push(r[i][0]),r[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);d&&d(t);while(g.length)g.shift()();return s.push.apply(s,l||[]),o()}function o(){for(var e,t=0;t<s.length;t++){for(var o=s[t],a=!0,n=1;n<o.length;n++){var c=o[n];0!==r[c]&&(a=!1)}a&&(s.splice(t--,1),e=i(i.s=o[0]))}return e}var a={},r={index:0},s=[];function i(t){if(a[t])return a[t].exports;var o=a[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=a,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(o,a,function(t){return e[t]}.bind(null,a));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],c=n.push.bind(n);n.push=t,n=n.slice();for(var l=0;l<n.length;l++)t(n[l]);var d=c;s.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("8d7d")},"0d6c":function(e,t,o){"use strict";o("b9de")},"1dc2":function(e,t,o){"use strict";o("9a12")},"1ffb":function(e,t,o){},2179:function(e,t,o){"use strict";o("d051")},"27d3":function(e,t,o){},"35fb":function(e,t,o){"use strict";o("3eb2")},"3eb2":function(e,t,o){},"4d9a":function(e,t,o){"use strict";o("27d3")},"5ca3":function(e,t,o){"use strict";o("7f10")},"5ffa":function(e,t,o){e.exports=o.p+"img/gesoc_logo.56d0443f.png"},"642a":function(e,t,o){},"65fd":function(e,t,o){"use strict";o("9fb3")},"6d21":function(e,t,o){"use strict";o("642a")},7429:function(e,t,o){},"7f10":function(e,t,o){},"8d27":function(e,t,o){},"8d7d":function(e,t,o){"use strict";o.r(t);o("e260"),o("e6cf"),o("cca6"),o("a79d");var a=o("2b0e"),r=o("8c4f"),s=o("5f5b"),i=o("b1e0"),n=(o("f9e3"),o("2dd8"),function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("transition",{attrs:{name:"fade",mode:"out-in"}},[o("router-view")],1)}),c=[],l={},d=l,u=(o("cb73"),o("2877")),g=Object(u["a"])(d,n,c,!1,null,null,null),p=g.exports,m=(o("b0c0"),o("c975"),o("fb6a"),o("ac1f"),o("1276"),o("d4ec")),f=o("bee2"),v=o("bc3a"),h=o.n(v),b=o("1232");function C(e){var t=new Date(Date.parse(e));return("0"+t.getDate()).slice(-2)+"/"+("0"+(t.getMonth()+1)).slice(-2)+"/"+t.getFullYear()}function _(e){for(var t=e+"=",o=decodeURIComponent(document.cookie),a=o.split(";"),r=0;r<a.length;r++){var s=a[r];while(" "==s.charAt(0))s=s.substring(1);if(0==s.indexOf(t))return s.substring(t.length,s.length)}return""}var y=function(){function e(){Object(m["a"])(this,e)}return Object(f["a"])(e,null,[{key:"get",value:function(e,t,o){var a=sessionStorage.getItem("token");a&&(o?o.headers={Authorization:a}:o={headers:{Authorization:a}}),h.a.get(e,o).then((function(e){var o=e.data;switch(o.code){case 200:t.success&&t.success(o);break;case 400:t.failed&&t.failed(o);break;case 401:t.notLoggedIn&&t.notLoggedIn(o);break;case 403:t.forbidden&&t.forbidden(o);break;case 404:t.empty&&t.empty(o);break;default:t.default&&t.default(o)}})).catch((function(e){t.error&&t.error(e)})).then((function(){t.always&&t.always()}))}},{key:"post",value:function(e,t,o,a){var r=sessionStorage.getItem("token");r&&(a?a.headers={Authorization:r}:a={headers:{Authorization:r}}),h.a.post(e,t,a).then((function(e){var t=e.data;switch(e.headers.authorization&&(sessionStorage.setItem("token",e.headers.authorization),sessionStorage.setItem("authRol",Object(b["a"])(e.headers.authorization).rol)),t.code){case 200:o.success&&o.success(t);break;case 400:o.failed&&o.failed(t);break;case 401:o.notLoggedIn&&o.notLoggedIn(t);break;case 403:o.forbidden&&o.forbidden(t);break;case 404:o.empty&&o.empty(t);break;default:o.default&&o.default(t)}})).catch((function(e){o.error&&o.error(e)})).then((function(){o.always&&o.always()}))}},{key:"patch",value:function(e,t,o,a){var r=sessionStorage.getItem("token");r&&(a?a.headers={Authorization:r}:a={headers:{Authorization:r}}),h.a.patch(e,t,a).then((function(e){var t=e.data;switch(t.code){case 200:o.success&&o.success(t);break;case 400:o.failed&&o.failed(t);break;case 401:o.notLoggedIn&&o.notLoggedIn(t);break;case 403:o.forbidden&&o.forbidden(t);break;case 404:o.empty&&o.empty(t);break;default:o.default&&o.default(t)}})).catch((function(e){o.error&&o.error(e)})).then((function(){o.always&&o.always()}))}}]),e}(),x=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("navbar",{attrs:{userData:e.userData},on:{toggleSidebar:function(t){e.sidebarShow=!e.sidebarShow}}}),o("div",{staticClass:"d-flex",class:{toggled:!e.sidebarShow},attrs:{id:"wrapper"}},[o("sidebar",{attrs:{sidebar:e.sidebar},on:{closeSidebar:function(t){e.sidebarShow=!0}}}),o("div",{staticClass:"w-100 overflow-auto"},[o("breadcrumb"),o("div",{staticClass:"overflow-auto",staticStyle:{height:"calc(100vh - 106px)"}},[o("transition",{attrs:{name:"fade",mode:"out-in"}},[o("router-view",{key:e.routerViewKey})],1)],1)],1)],1),o("b-modal",{attrs:{id:"login-modal",centered:"","hide-footer":"","hide-header":"","no-close-on-esc":"","no-close-on-backdrop":"",size:"sm"}},[o("div",[o("h3",[e._v("Se cerró la sesión")]),o("p",[e._v("Vuelva a iniciar sesión para continuar")]),o("loginForm",{on:{loginSuccess:e.loginSuccess}})],1)]),o("b-modal",{attrs:{id:"spark-modal","ok-title":"Cerrar","ok-only":"","hide-header":"",size:"sm","modal-class":"modal-fullscreen"}},[o("iframe",{staticStyle:{width:"100%",height:"100%"},attrs:{srcdoc:e.debugSparkModalHTML}},[o("p",[e._v("Your browser does not support iframes.")])])]),o("b-alert",{staticClass:"position-fixed fixed-bottom m-0 rounded-0",staticStyle:{"z-index":"2000"},attrs:{variant:e.alert.variant,dismissible:""},model:{value:e.alert.show,callback:function(t){e.$set(e.alert,"show",t)},expression:"alert.show"}},[e._v(e._s(e.alert.message))])],1)},I=[],w=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-overlay",{attrs:{"spinner-variant":"light",variant:"primary",rounded:"sm",show:e.loginLoading,"no-wrap":""}}),o("form",{staticClass:"pt-2",on:{submit:function(t){return t.preventDefault(),e.loginAttempt(t)}}},[o("b-collapse",{attrs:{visible:0==e.userState}},[o("p",{staticClass:"text-danger text-left m-0"},[o("span",[e._v("Completa el campo usuario")])])]),o("b-form-input",{staticClass:"mb-2 border-secondary",attrs:{state:e.userState,type:"text",placeholder:"Usuario"},model:{value:e.user,callback:function(t){e.user=t},expression:"user"}}),o("b-collapse",{attrs:{visible:0==e.passState}},[o("p",{staticClass:"text-danger text-left m-0"},[o("span",[e._v("Completa el campo contraseña")])])]),o("b-input-group",{scopedSlots:e._u([{key:"append",fn:function(){return[o("b-button",{attrs:{variant:"outline-secondary"},on:{click:function(t){e.showPassword=!e.showPassword}}},[o("b-icon",{attrs:{icon:e.showPassword?"eye-slash":"eye"}})],1)]},proxy:!0}])},[o("b-form-input",{staticClass:"border-secondary",attrs:{state:e.passState,type:e.showPassword?"text":"password",placeholder:"Contraseña"},model:{value:e.pass,callback:function(t){e.pass=t},expression:"pass"}})],1),o("b-collapse",{staticClass:"mt-2",attrs:{visible:0==e.loginState}},[o("p",{staticClass:"text-danger text-left m-0"},[o("span",[e._v("Usuario y/o contraseña no coinciden")])])]),o("b-button",{staticClass:"mt-4",attrs:{variant:"primary",type:"submit"}},[e._v("Iniciar Sesión")])],1)],1)},P=[],A={data:function(){return{user:"",pass:"",loginData:null,loginState:null,userState:null,passState:null,loginLoading:!1,showPassword:!1}},methods:{loginAttempt:function(){var e=this;if(this.loginState=null,this.userState=null,this.passState=null,""==this.user&&(this.userState=!1),""==this.pass&&(this.passState=!1),""!=this.user&&""!=this.pass){this.loginLoading=!0;var t={username:this.user,password:this.pass};y.post("/api/auth/login",t,{success:function(t){e.$emit("loginSuccess")},empty:function(){e.loginState=!1},error:function(t){e.$bvToast.toast("Ocurrió un error al iniciar sesión",{title:"Error",variant:"danger",toaster:"b-toaster-bottom-right",solid:!0,appendToToast:!0})},always:function(){e.loginLoading=!1}})}}}},k=A,S=Object(u["a"])(k,w,P,!1,null,null,null),E=S.exports,L=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("b-breadcrumb",{staticClass:"m-0 border-bottom bg-light",staticStyle:{"border-radius":"0"}},[o("b-breadcrumb-item",{attrs:{to:"/"}},[o("b-icon-house")],1),e._l(e.breadcrumb,(function(t,a){return[o("b-breadcrumb-item",{key:a,attrs:{to:t.path,active:t.active}},[e._v(" "+e._s(t.label)+" ")])]}))],2)},O=[],j=(o("4160"),o("5319"),o("159b"),{data:function(){return{breadcrumb:[]}},methods:{updateBreadcrumb:function(){var e=this;if(void 0!=this.$route.meta.breadcrumb){var t=JSON.parse(JSON.stringify(this.$route.meta.breadcrumb));t.forEach((function(t){if("dynamic"==t.type){var o=t.dynamicText,a=e.$route.params[o];void 0!=a&&(t.label=t.label.replace(o,a),t.path=t.path.replace(o,a))}})),this.breadcrumb=t}else this.breadcrumb=[]}},watch:{$route:function(e,t){this.updateBreadcrumb()}},mounted:function(){this.updateBreadcrumb()}}),$=j,D=Object(u["a"])($,L,O,!1,null,null,null),M=D.exports,H=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("nav",{staticClass:"navbar navbar-expand-md navbar-dark d-flex bg-dark flex-nowrap"},[a("button",{staticClass:"navbar-toggler border-0 p-1 mr-2",attrs:{"data-toggle":"collapse"},on:{click:e.toggleSidebar}},[a("span",{staticClass:"navbar-toggler-icon"})]),a("router-link",{staticClass:"navbar-brand mr-2",attrs:{id:"navbar-organizacion",to:"/"}},[a("img",{staticClass:"d-inline-block align-top",staticStyle:{filter:"invert(1)"},attrs:{src:o("929a"),width:"30",height:"30"}}),a("span",{staticClass:"p-2"},[e._v(e._s(e.userData.organizacion))])]),a("div",{staticClass:"ml-auto user-panel-avatar",on:{click:function(t){e.userPanelShow=!0}}},[a("b-avatar",{attrs:{variant:"primary",text:e.userData.nombre.substring(0,1)}})],1),a("b-modal",{attrs:{"hide-footer":"","hide-header":"","hide-backdrop":"","body-class":"p-0 rounded overflow-hidden","dialog-class":"user-panel","content-class":"shadow"},model:{value:e.userPanelShow,callback:function(t){e.userPanelShow=t},expression:"userPanelShow"}},[a("b-list-group",{attrs:{flush:""}},[a("b-list-group-item",{attrs:{to:e.miCuenta()},on:{click:function(t){e.userPanelShow=!1}}},[a("b-icon-person-fill",{staticClass:"mr-2"}),e._v(" "+e._s(e.userData.nombre)+" "+e._s(e.userData.apellido)+" ")],1),a("b-list-group-item",{attrs:{button:""},on:{click:e.logout}},[a("b-icon-box-arrow-left",{staticClass:"mr-2"}),e._v(" Cerrar sesión ")],1)],1)],1)],1)},z=[],T={props:{userData:Object},data:function(){return{userPanelShow:!1}},inject:["errorHandling"],methods:{toggleSidebar:function(){this.$emit("toggleSidebar")},logout:function(){var e=this;y.post("/api/auth/logout",null,{always:function(){sessionStorage.clear(),e.$router.push("/login")}})},miCuenta:function(){return"Administrador"==sessionStorage.getItem("authRol")?"/admin/cuenta":"/cuenta"}}},F=T,N=Object(u["a"])(F,H,z,!1,null,null,null),J=N.exports,R=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"border-right",attrs:{id:"sidebar-wrapper"}},[o("b-list-group",{attrs:{flush:""}},[e._l(e.sidebar,(function(t,a){return[o("b-list-group-item",{key:a,staticClass:"d-flex align-items-center",attrs:{to:t.to,active:e.active(t)}},[o("b-icon",{staticClass:"mr-2",attrs:{icon:t.icon}}),o("span",[e._v(e._s(t.text))]),t.bandeja&&e.mensajesCount?o("b-badge",{staticClass:"ml-auto",attrs:{variant:"success",pill:""}},[e._v(e._s(e.mensajesCount))]):e._e()],1)]}))],2)],1)},V=[],U=(o("d81d"),o("13d5"),{props:{sidebar:Array},data:function(){return{update:!0,updating:!1,updateSpeed:2e4,mensajesCount:0}},inject:["showLoginModal","errorHandling","createToast"],methods:{closeSidebar:function(){this.$emit("closeSidebar")},active:function(e){return this.$route.meta.breadcrumb&&this.$route.meta.breadcrumb[0]?this.$route.meta.breadcrumb[0].label==e.text:this.$route.name==e.routeName},cargarMensajesAPI:function(){var e=this;"Administrador"!=sessionStorage.getItem("authRol")&&(y.get("/api/bandeja",{success:function(t){t.mensajes.length&&(e.mensajesCount=t.mensajes.map((function(e){return e.leido?0:1})),e.mensajesCount=e.mensajesCount.reduce((function(e,t){return e+t})))},notLoggedIn:function(){e.showLoginModal(!0)},forbidden:function(t){e.errorHandling(t)},empty:function(){e.mensajes=[]},error:function(t){e.errorHandling(t)}}),this.update&&!this.updating&&(this.updating=!0,setTimeout((function(){e.updating=!1,e.cargarMensajesAPI()}),this.updateSpeed)))}},mounted:function(){this.cargarMensajesAPI()}}),B=U,q=(o("65fd"),Object(u["a"])(B,R,V,!1,null,null,null)),G=q.exports,K={props:{sidebar:Array},data:function(){return{userData:{nombre:"",apellido:"",username:"",email:""},sidebarShow:!0,reloadPage:!1,routerViewKey:0,loading:!0,debugSparkModalHTML:"",alert:{show:!1,message:"",variant:""}}},methods:{loginSuccess:function(){this.reloadPage&&this.softReloadPage(),this.getUserData(),this.$bvModal.hide("login-modal")},softReloadPage:function(){this.routerViewKey?this.routerViewKey++:this.routerViewKey--},showLoginModal:function(e){this.reloadPage=e,this.$bvModal.show("login-modal")},createToast:function(e,t,o,a){this.$bvToast.toast(t,{title:e,variant:o,toaster:"b-toaster-bottom-right",solid:!0,appendToToast:void 0==a||a})},errorHandling:function(e){if(e.response)switch(e.response.status){case 500:this.$bvModal.show("spark-modal"),this.debugSparkModalHTML=e.response.data;break;default:this.createToast("Error","Ha ocurrido un error, vuelva a intentarlo mas tarde","danger")}else if(e.code)switch(e.code){case 403:this.alert.show=!0,this.alert.message="Error 403, ".concat(e.message),this.alert.variant="warning";break}},getUserData:function(){var e=this;y.get("/api/auth/me",{success:function(t){e.userData.username=t.username,e.userData.nombre=t.nombre,e.userData.apellido=t.apellido,e.userData.email=t.email},notLoggedIn:function(t){e.showLoginModal(!0)},forbidden:function(t){console.log("asd"),e.errorHandling(t)},error:function(t){e.errorHandling(t)}})}},mounted:function(){this.getUserData()},provide:function(){return{showLoginModal:this.showLoginModal,errorHandling:this.errorHandling,createToast:this.createToast}},components:{loginForm:E,breadcrumb:M,navbar:J,sidebar:G}},Y=K,Q=(o("1dc2"),Object(u["a"])(Y,x,I,!1,null,null,null)),W=Q.exports,X=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login-container d-flex w-100 h-100 justify-content-center"},[a("div",{staticClass:"login-centerer h-100 d-flex align-items-center p-3 text-center"},[a("div",[a("img",{staticClass:"mb-4",attrs:{src:o("5ffa"),alt:"",width:"150",height:"150"}}),a("h3",[e._v("Por favor inicia sesión")]),a("loginForm",{on:{loginSuccess:e.loginRedirect}})],1)])])},Z=[],ee={methods:{loginRedirect:function(){var e=sessionStorage.getItem("token");if(e){var t=Object(b["a"])(e);switch(t.rol){case"Estandar":this.$router.push("/");break;case"Administrador":this.$router.push("/admin");break}}}},mounted:function(){this.loginRedirect()},components:{loginForm:E}},te=ee,oe=(o("5ca3"),Object(u["a"])(te,X,Z,!1,null,null,null)),ae=oe.exports,re=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},se=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"p-4"},[o("h1",[e._v("Error 404")]),o("p",[e._v("La pagina que ha intentado acceder no se encuentra")])])}],ie={},ne=ie,ce=Object(u["a"])(ne,re,se,!1,null,null,null),le=ce.exports,de=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"p-4"},[o("h1",[e._v("Error 401")]),o("p",[e._v("No esta autorizado para entrar a esta página")]),o("b-link",{staticClass:"mr-2",on:{click:function(t){return e.$router.go(-2)}}},[e._v("Ir atras")])],1)},ue=[],ge={},pe=ge,me=Object(u["a"])(pe,de,ue,!1,null,null,null),fe=me.exports,ve=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},he=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"p-4"},[o("h1",[e._v("Error 500")]),o("p",[e._v("Ha ocurrido un error en el servidor")])])}],be={},Ce=be,_e=Object(u["a"])(Ce,ve,he,!1,null,null,null),ye=_e.exports,xe=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},Ie=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"container-fluid"},[o("h1",{staticClass:"mt-4"},[e._v("Conta Gestión v2020.10.2")]),o("p",[e._v("Seleccione alguna actividad en el menú para iniciar")])])}],we={},Pe=we,Ae=Object(u["a"])(Pe,xe,Ie,!1,null,null,null),ke=Ae.exports,Se=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"px-1 px-md-3 px-lg-5 py-4 d-flex justify-content-center"},[o("div",{staticClass:"operaciones-wrapper"},[o("b-button",{staticClass:"mb-4",attrs:{variant:"outline-primary"},on:{click:e.vincularAutomaticamenteAPI}},[e._v("Vinculación de Egresos e Ingresos "),o("b-icon-vr")],1),o("b-nav",{attrs:{tabs:""}},[o("b-nav-item",{attrs:{active:e.egresoOpened(),to:"/operaciones/egreso"}},[e._v("Egresos")]),o("b-nav-item",{attrs:{active:e.ingresoOpened(),to:"/operaciones/ingreso"}},[e._v("Ingresos")])],1),o("transition",{attrs:{name:"fade",mode:"out-in"}},[e.egresoOpened()||e.ingresoOpened()?e._e():o("div",{key:"vacio",staticClass:"border border-top-0 d-flex justify-content-center align-items-center p-2",staticStyle:{height:"300px"}},[o("div",{staticClass:"text-center text-secondary"},[o("p",{staticClass:"pb-4"},[e._v("Seleccione algún tipo de operación")])])]),o("router-view")],1)],1)])},Ee=[],Le={data:function(){return{publicPath:"/"}},inject:["showLoginModal","createToast","errorHandling"],methods:{egresoOpened:function(){return"egresos"==this.$route.name||"egreso"==this.$route.name},ingresoOpened:function(){return"ingresos"==this.$route.name},vincularAutomaticamenteAPI:function(){var e=this;y.get("/api/operaciones/asociarAutomaticamente",{success:function(t){e.createToast("Vinculación exitosa","Se vinculador los Egresos con los Ingresos exitosamente","success"),console.log(t)},notLoggedIn:function(){e.showLoginModal(!0)},failed:function(t){e.createToast("Error","No se pudo vincular los Egresos e Ingresos, pruebe nuevamente mas tarde","danger"),console.log(t)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.loading=!1},default:function(e){console.log(e)}})}}},Oe=Le,je=(o("2179"),Object(u["a"])(Oe,Se,Ee,!1,null,null,null)),$e=je.exports,De=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"border border-top-0"},[o("b-overlay",{staticClass:"border-bottom",attrs:{variant:"primary","spinner-variant":"light",show:e.egresosLoading}},[o("b-table",{staticClass:"mb-0 border-0 border-bottom table-row-pointer",attrs:{"show-empty":"","tbody-tr-class":e.rowStyle,"head-variant":"dark",fields:e.campos_egresos,items:e.egresos,"sort-by":"name"},on:{"sort-changed":e.test,"row-clicked":e.toggleEgreso},scopedSlots:e._u([{key:"cell(validado)",fn:function(t){return[t.item.validado?o("b-badge",{attrs:{variant:"success"}},[e._v("Validado")]):o("b-badge",{attrs:{variant:"warning"}},[e._v("Sin Validar")])]}},{key:"cell(valorTotal)",fn:function(t){return[o("span",[e._v(e._s("$"+t.item.valorTotal))])]}},{key:"row-details",fn:function(t){return[o("b-collapse",{attrs:{visible:t.item.showEgreso&&e.egresoLoading}},[o("div",{staticClass:"text-center p-4"},[o("b-spinner",{attrs:{variant:"light",label:"Spinning"}})],1)]),o("b-collapse",{attrs:{visible:t.item.showEgreso&&!e.egresoLoading}},[o("transition",{attrs:{name:"fade"}},[t.item.showEgreso?o("egreso",{key:e.egresoKey,ref:"egreso",attrs:{egresoLoaded:e.egresoLoaded}}):e._e()],1)],1)]}},{key:"empty",fn:function(){return[o("h4",[e._v("No hay egresos para mostrar")])]},proxy:!0}])})],1),o("b-button",{staticClass:"m-2",attrs:{variant:"outline-primary",to:"/operaciones/egreso/agregar"}},[o("b-icon-plus"),e._v(" Agregar Egreso ")],1)],1)},Me=[],He=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"px-2 pb-2 egreso_container"},[e.egreso?o("b-card",[o("b-overlay",{attrs:{"spinner-variant":"light",variant:"primary",show:e.egresoLoading,"no-wrap":""},scopedSlots:e._u([{key:"overlay",fn:function(){return[o("div",[o("div",{staticClass:"d-flex justify-content-center"},[o("b-spinner",{staticClass:"flex-shrink-0",attrs:{variant:"light"}})],1),e.archivo?o("div",{staticClass:"mt-4"},[o("p",{staticClass:"text-light"},[e._v("Subiendo archivo")]),o("b-progress",{staticClass:"progress-min-width bg-transparent",attrs:{variant:"light",max:"100",height:"2rem"}},[o("b-progress-bar",{attrs:{value:e.archivoProgress}},[o("strong",{staticClass:"text-secondary"},[e._v(e._s(e.archivoProgress)+"%")])])],1)],1):e._e()])]},proxy:!0}],null,!1,834884673)}),e.egreso.categorias.length?[o("div",{staticClass:"mb-2"},[e._v(" Categorias: "),e._l(e.egreso.categorias,(function(t,a){return[o("b-badge",{key:a,staticClass:"mr-1"},[e._v(e._s(t.descripcion))])]}))],2)]:e._e(),o("div",{staticClass:"row m-0"},[o("div",{staticClass:"col p-0 pr-1"},[o("b-list-group",[o("b-list-group-item",{staticClass:"p-2 text-center",class:{"bg-secondary":e.showDatosProveedor,"text-light":e.showDatosProveedor},attrs:{button:""},on:{click:function(t){e.showDatosProveedor=!e.showDatosProveedor}}},[o("strong",[e._v("Proveedor")]),e._v(" "+e._s(e.egreso.proveedor.nombre))]),o("b-list-group-item",{staticClass:"p-0 overflow-hidden"},[o("b-collapse",{attrs:{visible:e.showDatosProveedor}},[o("b-list-group",{attrs:{flush:""}},[o("b-list-group-item",{staticClass:"p-2"},[o("strong",[e._v("Calle: ")]),e._v(e._s(e.egreso.proveedor.calle))]),o("b-list-group-item",{staticClass:"p-2"},[o("strong",[e._v("Altura: ")]),e._v(e._s(e.egreso.proveedor.altura))]),o("b-list-group-item",{staticClass:"p-2"},[o("strong",[e._v("Piso: ")]),e._v(e._s(e.egreso.proveedor.piso))]),o("b-list-group-item",{staticClass:"p-2"},[o("strong",[e._v("Codigo Postal: ")]),e._v(e._s(e.egreso.proveedor.zipcode))])],1)],1)],1)],1)],1),e.egreso.documento?o("div",{staticClass:"col p-0 pl-1"},[o("b-list-group",[o("b-list-group-item",{staticClass:"p-2 text-center",class:{"bg-secondary":e.showDatosFactura,"text-light":e.showDatosFactura},attrs:{button:""},on:{click:function(t){e.showDatosFactura=!e.showDatosFactura}}},[o("strong",[e._v("Documento")]),e._v(" "+e._s(e.egreso.documento.tipo.nombreTipoDeDocumento))]),o("b-list-group-item",{staticClass:"p-0 overflow-hidden"},[o("b-collapse",{attrs:{visible:e.showDatosFactura}},[o("b-list-group",{attrs:{flush:""}},[o("b-list-group-item",{staticClass:"p-2"},[o("strong",[e._v("Número Documento: ")]),e._v(e._s(e.egreso.documento.numDocumento))]),o("b-list-group-item",{staticClass:"p-2"},[o("strong",[e._v("Fecha Pedido: ")]),e._v(e._s(e.convertDate(e.egreso.documento.fechaDePedido)))]),o("b-list-group-item",{staticClass:"p-2"},[o("strong",[e._v("Fecha Entrega: ")]),e._v(e._s(e.convertDate(e.egreso.documento.fechaDeEntrega)))]),o("b-list-group-item",{staticClass:"p-2"},[o("strong",[e._v("Descripcion: ")]),e._v(e._s(e.egreso.documento.descripcion))]),e.egreso.documento.pathAdjunto?o("b-list-group-item",{staticClass:"p-2",attrs:{href:"/files/"+e.egreso.documento.pathAdjunto,target:"_blank"}},[o("span",{staticClass:"text-primary"},[e._v(" Archivo adjunto "),o("b-icon-box-arrow-in-up-right")],1)]):o("b-list-group-item",{staticClass:"p-2"},[o("b-input-group",{scopedSlots:e._u([{key:"append",fn:function(){return[o("b-button",{attrs:{variant:"outline-secondary"},on:{click:function(t){e.archivo=null}}},[o("b-icon-x")],1),o("transition",{attrs:{name:"fade"}},[e.archivo?o("b-button",{attrs:{variant:"outline-primary"},on:{click:e.uploadFileAPI}},[o("b-icon-upload")],1):e._e()],1)]},proxy:!0}],null,!1,3684331739)},[o("b-form-file",{attrs:{placeholder:"Seleccione un archivo o sueltelo aqui","drop-placeholder":"Suelta el archivo aqui...","browse-text":"Buscar"},model:{value:e.archivo,callback:function(t){e.archivo=t},expression:"archivo"}})],1)],1)],1)],1)],1)],1)],1):e._e()]),o("div",{staticClass:"row m-0"},[o("div",{staticClass:"col p-0 pt-2"},[o("b-list-group",[o("b-list-group-item",{staticClass:"p-2"},[o("strong",[e._v("Medio de pago: ")]),e._v(e._s(e.egreso.pago.medioDePago.medioDePago)+" "+e._s(e.egreso.pago.codigoAsociado))])],1)],1)]),o("div",{staticClass:"row m-0 pt-2"},[o("div",{staticClass:"col p-0 rounded overflow-hidden border"},[o("b-table",{staticClass:"m-0 border-0",attrs:{borderless:"","foot-clone":"",fields:e.campos_items,items:e.egreso.items},scopedSlots:e._u([{key:"cell(precio)",fn:function(t){return[o("span",[e._v(e._s("$"+t.item.precio))])]}},{key:"foot(tipoItem)",fn:function(){return[o("span")]},proxy:!0},{key:"foot(descripcion)",fn:function(){return[o("span")]},proxy:!0},{key:"foot(cantidad)",fn:function(){return[o("span",[e._v("Total")])]},proxy:!0},{key:"foot(precio)",fn:function(){return[o("span",[e._v(e._s("$"+e.egreso.valorTotal))])]},proxy:!0}],null,!1,2968386989)})],1)]),e.egreso.ingresoAsociado?o("div",{staticClass:"row m-0 pt-2"},[o("div",{staticClass:"col p-0"},[o("b-list-group",[o("b-list-group-item",{staticClass:"p-2 text-center",class:{"bg-secondary":e.showIngreso,"text-light":e.showIngreso},attrs:{button:""},on:{click:function(t){e.showIngreso=!e.showIngreso}}},[o("strong",[e._v("Ingreso")])]),o("b-list-group-item",{staticClass:"p-0 overflow-hidden"},[o("b-collapse",{attrs:{visible:e.showIngreso}},[o("b-list-group",{attrs:{flush:""}},[o("b-list-group-item",{staticClass:"p-2"},[o("strong",[e._v("Fecha Operacion")]),e._v(" "+e._s(e.convertDate(e.egreso.ingresoAsociado.fechaOperacion)))]),o("b-list-group-item",{staticClass:"p-2"},[o("strong",[e._v("Descripcion")]),e._v(" "+e._s(e.egreso.ingresoAsociado.descripcion))]),o("b-list-group-item",{staticClass:"p-2"},[o("strong",[e._v("Total:")]),e._v(" "+e._s("$"+e.egreso.ingresoAsociado.montoTotal))])],1)],1)],1)],1)],1)]):e._e(),e.egreso.cantidadPresupuestos?o("div",{staticClass:"pt-2"},[o("b-alert",{staticClass:"m-0",attrs:{variant:e.egreso.presupuestos.length>=e.egreso.cantidadPresupuestos?"info":"warning",size:"sm",show:""}},[e._v(" Este egreso tiene "),o("strong",[e._v(e._s(e.egreso.presupuestos.length))]),e._v(" de "),o("strong",[e._v(e._s(e.egreso.cantidadPresupuestos))]),e._v(" presupuestos requeridos ")])],1):e._e(),e.egreso.presupuestos.length?o("div",{staticClass:"row m-0 pt-2"},[o("div",{staticClass:"col p-0"},[o("b-list-group",[o("b-list-group-item",{staticClass:"p-2 text-center",class:{"bg-secondary":e.showPresupuestos,"border-bottom-0":e.showPresupuestos,"text-light":e.showPresupuestos},attrs:{button:""},on:{click:function(t){e.showPresupuestos=!e.showPresupuestos}}},[o("strong",[e._v("Presupuestos")]),o("b-badge",{staticClass:"ml-2",attrs:{variant:"light"}},[o("strong",[e._v(e._s(e.egreso.presupuestos.length))])])],1),o("b-list-group-item",{staticClass:"p-0 border-0 overflow-hidden"},[o("b-collapse",{attrs:{visible:e.showPresupuestos}},e._l(e.egreso.presupuestos,(function(t,a){return o("div",{key:a,staticClass:"px-2 pb-2 bg-secondary"},[o("div",{class:{"presupuesto-elegido":e.presupuestoElegido(t)}},[e.presupuestoElegido(t)?o("b-badge",{staticClass:"badge-elegido",attrs:{variant:"success"}},[e._v("ELEGIDO")]):e._e(),o("b-list-group",[o("b-list-group-item",{staticClass:"p-2 d-flex justify-content-between"},[o("span",[o("strong",[e._v("Proveedor")]),e._v(" "+e._s(t.proveedor.nombre)+" ")]),o("span",[o("strong",[e._v("Fecha Vigente")]),e._v(" "+e._s(e.convertDate(t.fechaVigente))+" ")])]),o("div",{staticClass:"p-0 bg-light overflow-hidden"},[o("b-table",{staticClass:"m-0 border-0",attrs:{borderless:"","foot-clone":"",fields:e.campos_items,items:t.items.map(e.itemEgresoAPIConverter)},scopedSlots:e._u([{key:"cell(precio)",fn:function(t){return[o("span",[e._v(e._s("$"+t.item.precio))])]}},{key:"foot(tipoItem)",fn:function(){return[o("span")]},proxy:!0},{key:"foot(descripcion)",fn:function(){return[o("span")]},proxy:!0},{key:"foot(cantidad)",fn:function(){return[o("span",[e._v("Total")])]},proxy:!0},{key:"foot(precio)",fn:function(){return[o("span",[e._v(e._s("$"+t.valorTotal))])]},proxy:!0}],null,!0)})],1)],1)],1)])})),0)],1)],1)],1)]):e._e(),o("div",{staticClass:"row m-0"},[o("div",{staticClass:"col p-0 pt-2"},[o("b-collapse",{attrs:{visible:e.falloCarga}},[o("b-badge",{attrs:{variant:"danger"}},[e._v(e._s(e.falloCargaDetalles))])],1),o("b-button-toolbar",[o("b-button-group",{attrs:{size:"sm"}},[e.egreso.ingresoAsociado?e._e():[o("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-asociar-ingreso",modifiers:{"modal-asociar-ingreso":!0}}],attrs:{variant:"outline-secondary"}},[e._v("Asociar a Ingreso")])],o("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-asociar-categoria",modifiers:{"modal-asociar-categoria":!0}}],attrs:{variant:"outline-secondary"}},[e._v("Asociar a categorias")]),o("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-agregar-presupuesto",modifiers:{"modal-agregar-presupuesto":!0}}],attrs:{variant:"outline-secondary"}},[e._v("Agregar Presupuesto")]),e.egreso.estaSuscrito?[o("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-asociar-ingreso",modifiers:{"modal-asociar-ingreso":!0}}],attrs:{variant:"danger",disabled:""}},[o("b-icon-check"),e._v(" Suscrito")],1)]:[o("b-button",{attrs:{variant:"outline-danger"},on:{click:e.suscribirseAPI}},[e._v("Suscribirse")])]],2)],1)],1)])],2):o("div"),o("b-modal",{attrs:{id:"modal-asociar-ingreso","hide-footer":"",scrollable:"",centered:"",title:"Asociar a Ingreso"}},[o("asociar-ingreso",{attrs:{confirmarAccion:e.confirmarAsociarIngreso,cancelarAccion:e.cancelarAsociarIngreso}})],1),o("b-modal",{attrs:{id:"modal-asociar-categoria","hide-footer":"",scrollable:"",centered:"",title:"Asociar a Categoría"}},[o("asociar-categoria",{attrs:{confirmarAccion:e.confirmarAsociarCategorias,cancelarAccion:e.cancelarAsociarCategorias}})],1),e.egreso?o("b-modal",{attrs:{id:"modal-agregar-presupuesto",size:"xl","hide-footer":"",scrollable:"",centered:"",title:"Crear nuevo Presupuesto"}},[o("agregar-presupuesto",{attrs:{itemsReadOnly:JSON.parse(JSON.stringify(e.egreso.items)),confirmarAccion:e.confirmarNuevoPresupuesto,cancelarAccion:e.cancelarNuevoPresupuesto}})],1):e._e()],1)},ze=[],Te=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-overlay",{attrs:{"spinner-variant":"light",variant:"primary",show:e.categoriasLoading,"no-wrap":""}}),o("p",[e._v("Seleccione categorias para asociar al egreso")]),o("ul",{staticClass:"list-group"},e._l(e.criterios,(function(t,a){return o("criterio",{key:a,attrs:{criterio:t,"selecciono-categoria":e.seleccionoCategoria}})})),1),e.categoriasSeleccionadas.length?o("div",{staticClass:"pt-2"},[o("span",[e._v("Categorias seleccionadas: ")]),e._l(e.categoriasSeleccionadas,(function(t,a){return[o("b-badge",{key:a,staticClass:"mr-1"},[e._v(e._s(t.name))])]}))],2):e._e(),o("div",{staticClass:"row pt-4"},[o("div",{staticClass:"col d-flex justify-content-between"},[o("b-button-group",[o("b-button",{attrs:{variant:"primary"},on:{click:function(t){return e.confirmarAccion(e.categoriasSeleccionadas)}}},[e._v("Confirmar")]),o("b-button",{attrs:{variant:"outline-dark"},on:{click:e.cancelarAccion}},[e._v("Cancelar")])],1)],1)])],1)},Fe=[],Ne=(o("a434"),o("d3b7"),o("25f0"),function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.edit?o("li",{staticClass:"list-group-item p-0"},[o("b-input-group",{scopedSlots:e._u([{key:"prepend",fn:function(){return[o("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:e.criterio.id,expression:"(criterio.id)"}],staticClass:"criterio-toggle",attrs:{block:"",variant:"outline"}},[o("b-icon-caret-right-fill",{attrs:{scale:"0.5"}})],1)]},proxy:!0},{key:"append",fn:function(){return[o("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:e.criterio.id,expression:"(criterio.id)"}],attrs:{block:"",variant:"outline"}},[o("b-icon-x")],1)]},proxy:!0}])},[o("b-form-input",{staticClass:"border-0",attrs:{placeholder:"Criterio"},on:{change:function(t){return e.updateCriterioAPI(e.criterio.id,e.criterio.name)}},model:{value:e.criterio.name,callback:function(t){e.$set(e.criterio,"name",t)},expression:"criterio.name"}})],1),o("b-collapse",{attrs:{id:e.criterio.id}},[e._l(e.criterio.categorias,(function(t,a){return[o("b-input-group",{key:a,scopedSlots:e._u([{key:"append",fn:function(){return[o("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:e.criterio.id,expression:"(criterio.id)"}],attrs:{block:"",variant:"outline"}},[o("b-icon-x")],1)]},proxy:!0}],null,!0)},[o("b-form-input",{staticClass:"border-0",attrs:{placeholder:"Categoría"},on:{change:function(o){return e.updateCategoriaAPI(e.criterio.id,t.name)}},model:{value:t.name,callback:function(o){e.$set(t,"name",o)},expression:"categoria.name"}})],1)]})),e.criterio.criterios.length?o("ul",{staticClass:"list-group p-2"},e._l(e.criterio.criterios,(function(t,a){return o("criterio",{key:a,attrs:{criterio:t,edit:!0,"selecciono-categoria":e.seleccionoCategoria}})})),1):e._e()],2)],1):o("li",{staticClass:"list-group-item p-0"},[o("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:e.criterio.id,expression:"(criterio.id)"}],staticClass:"text-left p-2 criterio-toggle",attrs:{block:"",variant:"outline"}},[o("b-icon-caret-right-fill",{attrs:{scale:"0.5"}}),e._v(" "+e._s(e.criterio.name)+" ")],1),o("b-collapse",{attrs:{id:e.criterio.id}},[e._l(e.criterio.categorias,(function(t,a){return[o("b-form-checkbox",{key:a,staticClass:"py-2 ml-2",on:{input:function(o){return e.seleccionoCategoria({id:t.id,name:t.name},o)}}},[e._v(e._s(t.name))])]})),e.criterio.criterios.length?o("ul",{staticClass:"list-group p-2"},e._l(e.criterio.criterios,(function(t,a){return o("criterio",{key:a,attrs:{criterio:t,"selecciono-categoria":e.seleccionoCategoria}})})),1):e._e()],2)],1)}),Je=[],Re=(o("99af"),{name:"criterio",props:{edit:Boolean,criterio:Object,seleccionoCategoria:Function},data:function(){return{isOpen:!1}},methods:{createCriterio:function(){},deleteCriterio:function(e){},updateCriterioAPI:function(e,t){console.log("Update: {id: ".concat(e,", value: ").concat(t,"}"))},updateCategoriaAPI:function(e,t){console.log("Update: {id: ".concat(e,", value: ").concat(t,"}"))}}}),Ve=Re,Ue=(o("35fb"),Object(u["a"])(Ve,Ne,Je,!1,null,null,null)),Be=Ue.exports,qe={props:{confirmarAccion:Function,cancelarAccion:Function},data:function(){return{criterios:[],criteriosAPI:[],categoriasSeleccionadas:[],categoriasLoading:!1}},inject:["showLoginModal","errorHandling"],methods:{cargarCriteriosAPI:function(){var e=this;this.categoriasLoading=!0,y.get("/api/criterios",{success:function(t){e.criteriosAPI=t.criterios,e.procesarCriterios()},notLoggedIn:function(){e.showLoginModal(!0)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.categoriasLoading=!1}})},procesarCriterios:function(){var e=this;this.criteriosAPI.forEach((function(t){if(t.categorias||(t.categorias=[]),t.criterios||(t.criterios=[]),t.id=t.id.toString(),t.idCriterioPadre){var o=e.criterioPorId(t.idCriterioPadre);o.criterios||(o.criterios=[]),o.criterios.push(t)}}));var t=[],o=0;for(o=0;o<this.criteriosAPI.length;o++){var a=this.criteriosAPI[o];a.idCriterioPadre&&t.push(o)}for(o=t.length-1;o>=0;o--)this.criteriosAPI.splice(t[o],1);this.criterios=this.criteriosAPI},criterioPorId:function(e){var t=null;return this.criteriosAPI.forEach((function(o){o.id==e&&(t=o)})),t},seleccionoCategoria:function(e,t){if(t)this.categoriasSeleccionadas.push(e);else{var o=this.categoriasSeleccionadas.indexOf(e);this.categoriasSeleccionadas.splice(o,1)}}},mounted:function(){this.cargarCriteriosAPI()},components:{criterio:Be}},Ge=qe,Ke=Object(u["a"])(Ge,Te,Fe,!1,null,null,null),Ye=Ke.exports,Qe=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("p",[e._v("Seleccione el Ingreso para asociar a este Egreso")]),o("b-overlay",{attrs:{"spinner-variant":"primary",show:e.ingresosLoading,rounded:"sm"}},[o("b-form-select",{staticClass:"border-secondary",attrs:{options:e.ingresosSelect},scopedSlots:e._u([{key:"first",fn:function(){return[o("b-form-select-option",{attrs:{value:null,disabled:""}},[e._v("-- Selecciona un Ingreso --")])]},proxy:!0}]),model:{value:e.ingresoSelected,callback:function(t){e.ingresoSelected=t},expression:"ingresoSelected"}})],1),o("b-button-group",{staticClass:"mt-5"},[o("b-button",{attrs:{variant:"primary"},on:{click:function(t){return e.confirmarAccion(e.ingresoSelected)}}},[e._v("Confirmar")]),o("b-button",{attrs:{variant:"outline-dark"},on:{click:e.cancelarAccion}},[e._v("Cancelar")])],1)],1)},We=[],Xe={props:{confirmarAccion:Function,cancelarAccion:Function},data:function(){return{ingresosSelect:[],ingresoSelected:null,ingresosLoading:!1}},inject:["showLoginModal","errorHandling"],methods:{cargarIngresosAPI:function(){var e=this;this.ingresosLoading=!0,y.get("/api/operaciones/ingresos",{success:function(t){e.ingresosSelect=t.ingresos.map(e.ingresosAPIConverter)},notLoggedIn:function(){e.showLoginModal(!0)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.ingresosLoading=!1}})},ingresosAPIConverter:function(e){return{value:{id:e.id,montoTotal:e.montoTotal,montoRestante:e.montoRestante,descripcion:e.descripcion},text:e.descripcion+" - $"+e.montoRestante+"/$"+e.montoTotal}}},mounted:function(){this.cargarIngresosAPI()}},Ze=Xe,et=Object(u["a"])(Ze,Qe,We,!1,null,null,null),tt=et.exports,ot=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticStyle:{"overflow-x":"hidden"}},[o("transition",{attrs:{name:e.cargandoProveedor?"slide":"slide-back",mode:"out-in"}},[e.cargandoProveedor?o("div",{key:"1"},[o("h5",{staticClass:"text-center mb-4"},[e._v("Cargar Proveedor")]),o("agregar-proveedor",{attrs:{confirmarAccion:e.confirmarProveedor,cancelarAccion:e.cancelarProveedor}})],1):o("div",{key:"0"},[e.buscarEgresos?o("div",{staticClass:"row mb-4 mx-2"},[o("div",{staticClass:"col-sm-4 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Egreso")])])]),o("div",{staticClass:"col px-2"},[o("div",{staticClass:"w-100"},[o("b-collapse",{attrs:{visible:e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Seleccione un egreso")])],1),o("b-overlay",{attrs:{"spinner-variant":"primary",show:e.egresosLoading,rounded:"sm"}},[o("b-form-select",{attrs:{options:e.egresosSelect,state:!e.falloInput&&null},scopedSlots:e._u([{key:"first",fn:function(){return[o("b-form-select-option",{attrs:{value:null,disabled:""}},[e._v("-- Seleccionar un Egreso --")])]},proxy:!0}],null,!1,1203292686),model:{value:e.presupuesto.egreso,callback:function(t){e.$set(e.presupuesto,"egreso",t)},expression:"presupuesto.egreso"}})],1)],1)])]):e._e(),o("div",{staticClass:"row mb-4 mx-2"},[o("div",{staticClass:"col-sm-4 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Proveedor")])])]),o("div",{staticClass:"col px-2 d-flex align-items-end"},[o("div",{staticClass:"w-100"},[o("b-collapse",{attrs:{visible:!e.presupuesto.proveedor&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Seleccione un proveedor")])],1),o("b-overlay",{attrs:{"spinner-variant":"primary",show:e.proveedoresLoading,rounded:"sm"}},[o("b-form-select",{attrs:{options:e.proveedoresSelect,state:!(!e.presupuesto.proveedor&&e.falloInput)&&null},scopedSlots:e._u([{key:"first",fn:function(){return[o("b-form-select-option",{attrs:{value:null,disabled:""}},[e._v("-- Selecciona un Proveedor --")])]},proxy:!0}],null,!1,2692850679),model:{value:e.presupuesto.proveedor,callback:function(t){e.$set(e.presupuesto,"proveedor",t)},expression:"presupuesto.proveedor"}},[[null!=e.proveedorAAgregar?o("b-form-select-option",{staticClass:"text-primary",attrs:{value:"nuevoProveedor"}},[e._v(e._s(e.proveedorAAgregar.nombre)+" (nuevo)")]):e._e()]],2)],1)],1)]),o("div",{staticClass:"col px-2 d-flex align-items-end"},[o("b-button",{attrs:{block:"",variant:"outline-primary"},on:{click:function(t){e.cargandoProveedor=!0}}},[o("b-icon-plus"),e._v(" Cargar Proveedor ")],1)],1)]),o("div",{staticClass:"row mb-4 mx-2"},[o("div",{staticClass:"col-sm-4 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Fecha Vigente")])])]),o("div",{staticClass:"col px-2"},[o("b-collapse",{attrs:{visible:!e.presupuesto.fechaVigente&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Seleccione una fecha")])],1),o("b-form-datepicker",{staticClass:"mb-2",attrs:{state:!(!e.presupuesto.fechaVigente&&e.falloInput)&&null,placeholder:"Seleccione fecha de vigencia"},model:{value:e.presupuesto.fechaVigente,callback:function(t){e.$set(e.presupuesto,"fechaVigente",t)},expression:"presupuesto.fechaVigente"}})],1)]),o("div",{staticClass:"row mb-4 mx-2"},[o("div",{staticClass:"col-sm-4 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Items")])])]),o("div",{staticClass:"col p-2"},[o("tabla-items",{attrs:{itemsReadOnly:e.itemsReadOnly,actualizarItems:e.actualizarItems}})],1)]),o("div",{staticClass:"row mb-4 mx-2"},[o("div",{staticClass:"col-4"}),o("div",{staticClass:"col px-2"},[o("b-button-group",[o("b-button",{attrs:{variant:"primary"},on:{click:e.confirmar}},[e._v("Confirmar")]),o("b-button",{attrs:{variant:"outline-dark"},on:{click:e.cancelarAccion}},[e._v("Cancelar")])],1)],1)])])])],1)},at=[],rt=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[e.itemsReadOnly?o("b-table",{staticClass:"mb-0 rounded",attrs:{small:"",responsive:"",hover:"",bordered:"",fields:e.campos_items,items:e.itemsReadOnly,"head-variant":"dark","foot-variant":"light","foot-clone":""},scopedSlots:e._u([{key:"cell(precio)",fn:function(t){return[o("b-form-input",{staticClass:"border-0 px-2 bg-transparent text-center",attrs:{type:"number"},on:{input:e.addItem},model:{value:t.item.precio,callback:function(o){e.$set(t.item,"precio",o)},expression:"row.item.precio"}})]}},{key:"cell(delete)",fn:function(){},proxy:!0},{key:"foot(tipoItem)",fn:function(){return[o("span",{staticClass:"text-danger"})]},proxy:!0},{key:"foot(descripcion)",fn:function(){return[o("span",{staticClass:"text-danger"})]},proxy:!0},{key:"foot(cantidad)",fn:function(){return[o("span",{staticClass:"text-danger"},[e._v("Total")])]},proxy:!0},{key:"foot(precio)",fn:function(){return[o("span",{staticClass:"text-danger"},[e._v(e._s("$"+e.precioTotal()))])]},proxy:!0}])}):o("b-table",{staticClass:"mb-0 rounded",attrs:{small:"",responsive:"",hover:"",bordered:"",fields:e.campos_items,items:e.items,"head-variant":"dark","foot-variant":"light","foot-clone":""},scopedSlots:e._u([{key:"cell(tipoItem)",fn:function(t){return[o("b-form-select",{staticClass:"border-0 px-2 bg-transparent",attrs:{options:e.tipoItemsOptions},on:{input:e.addItem},scopedSlots:e._u([{key:"first",fn:function(){return[o("b-form-select-option",{attrs:{value:null,disabled:""}},[e._v("-- Tipo --")])]},proxy:!0}],null,!0),model:{value:t.item.tipoItem,callback:function(o){e.$set(t.item,"tipoItem",o)},expression:"row.item.tipoItem"}})]}},{key:"cell(descripcion)",fn:function(t){return[o("b-form-input",{staticClass:"border-0 px-2 bg-transparent",attrs:{list:"items-list"},on:{input:function(t){return e.addItem()}},model:{value:t.item.descripcion,callback:function(o){e.$set(t.item,"descripcion",o)},expression:"row.item.descripcion"}})]}},{key:"cell(precio)",fn:function(t){return[o("b-form-input",{staticClass:"border-0 px-2 bg-transparent text-center",attrs:{type:"number"},on:{input:e.addItem},model:{value:t.item.precio,callback:function(o){e.$set(t.item,"precio",o)},expression:"row.item.precio"}})]}},{key:"cell(cantidad)",fn:function(t){return[o("b-form-input",{staticClass:"border-0 px-2 bg-transparent text-center",attrs:{type:"number"},on:{input:e.addItem},model:{value:t.item.cantidad,callback:function(o){e.$set(t.item,"cantidad",o)},expression:"row.item.cantidad"}})]}},{key:"cell(delete)",fn:function(t){return[o("b-button",{staticClass:"px-2 m-0 text-danger",attrs:{variant:"outline"},on:{click:function(o){return e.deleteItem(t.index)}}},[o("b-icon-x")],1)]}},{key:"foot(tipoItem)",fn:function(){return[o("span",{staticClass:"text-danger"})]},proxy:!0},{key:"foot(descripcion)",fn:function(){return[o("span",{staticClass:"text-danger"})]},proxy:!0},{key:"foot(cantidad)",fn:function(){return[o("span",{staticClass:"text-danger"},[e._v("Total")])]},proxy:!0},{key:"foot(precio)",fn:function(){return[o("span",{staticClass:"text-danger"},[e._v(e._s("$"+e.precioTotal()))])]},proxy:!0}],null,!1,160145753)}),o("b-form-datalist",{attrs:{id:"items-list",options:e.itemsOptions}})],1)},st=[],it={props:{itemsReadOnly:Array,actualizarItems:Function},data:function(){return{items:[{tipoItem:null,descripcion:"",cantidad:"",precio:""}],tipoItemsOptions:[],itemsOptions:[],campos_items:[{key:"tipoItem",label:"Tipo",tdClass:["align-middle","text-center"],thClass:["tipo-th"]},{key:"descripcion",label:"Descripcion",tdClass:["align-middle"],thClass:["w-75"]},{key:"cantidad",label:"Cantidad",tdClass:["align-middle","text-center"],thClass:["text-center"]},{key:"precio",label:"Precio Unitario",tdClass:["align-middle"],thClass:["text-center","precio-th"]},{key:"delete",label:"",tdClass:["align-middle"],thClass:["text-center"]}]}},inject:["errorHandling","showLoginModal"],methods:{checkIfAddItem:function(){var e=this.items,t=e.length-1,o=e[t];return void 0==o||""!=o.descripcion||""!=o.cantidad||""!=o.precio||null!=o.tipoItem},addItem:function(){this.checkIfAddItem()&&this.items.push({tipoItem:null,descripcion:"",cantidad:"",precio:""}),this.itemsReadOnly?this.actualizarItems(this.itemsReadOnly):this.actualizarItems(this.items)},deleteItem:function(e){this.items.splice(e,1),this.addItem()},precioTotal:function(){var e=0,t=this.items;return this.itemsReadOnly&&(t=this.itemsReadOnly),t.forEach((function(t){var o=parseFloat(t.precio),a=parseInt(t.cantidad);isNaN(o)||isNaN(a)||(e+=o*a)})),e},searchItemAPI:function(){var e=this;y.get("/api/items",{success:function(t){e.itemsOptions=t.items.map((function(e){return e.descripcion}))},notLoggedIn:function(){e.showLoginModal(!0)},error:function(t){e.errorHandling(t)},forbidden:function(t){e.errorHandling(t)},always:function(){}})},searchTipoItemAPI:function(){var e=this;y.get("/api/tipoItems",{success:function(t){e.tipoItemsOptions=t.tipoItems.map((function(e){return{text:e.nombre,value:{id:e.id,nombre:e.nombre}}}))},notLoggedIn:function(){e.showLoginModal(!0)},error:function(t){e.errorHandling(t)},forbidden:function(t){e.errorHandling(t)},always:function(){}})}},mounted:function(){this.itemsReadOnly&&this.actualizarItems(this.itemsReadOnly),this.searchTipoItemAPI(),this.searchItemAPI()}},nt=it,ct=(o("d2b5"),Object(u["a"])(nt,rt,st,!1,null,null,null)),lt=ct.exports,dt=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"row mb-4 mx-2"},[e._m(0),o("div",{staticClass:"col px-2"},[o("b-collapse",{attrs:{visible:!e.proveedor.nombre&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Ingrese el nombre del proveedor")])],1),o("b-form-input",{attrs:{placeholder:"Ingrese nombre del proveedor",state:!(!e.proveedor.nombre&&e.falloInput)&&null},model:{value:e.proveedor.nombre,callback:function(t){e.$set(e.proveedor,"nombre",t)},expression:"proveedor.nombre"}})],1)]),o("div",{staticClass:"row mb-4 mx-2"},[e._m(1),o("div",{staticClass:"col px-2"},[o("b-collapse",{attrs:{visible:!e.proveedor.documento&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Ingrese documento del proveedor")])],1),o("b-form-input",{attrs:{placeholder:"Ingrese documento del proveedor",type:"number",state:!(!e.proveedor.documento&&e.falloInput)&&null},model:{value:e.proveedor.documento,callback:function(t){e.$set(e.proveedor,"documento",t)},expression:"proveedor.documento"}})],1)]),o("div",{staticClass:"row mb-4 mx-2"},[e._m(2),o("div",{staticClass:"col p-2"},[o("div",{staticClass:"p-2 container-fluid border border rounded"},[o("div",{staticClass:"row mb-2"},[e._m(3),o("div",{staticClass:"col"},[o("b-collapse",{attrs:{visible:!e.proveedor.pais&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Seleccione un país")])],1),o("b-overlay",{attrs:{"spinner-variant":"primary",show:e.paisesLoading,rounded:"sm"}},[o("b-form-select",{attrs:{state:!(!e.proveedor.pais&&e.falloInput)&&null,options:e.paises},on:{change:e.cargarProvinciasAPI},scopedSlots:e._u([{key:"first",fn:function(){return[o("b-form-select-option",{attrs:{value:null,disabled:""}},[e._v("-- Selecciona un país --")])]},proxy:!0}]),model:{value:e.proveedor.pais,callback:function(t){e.$set(e.proveedor,"pais",t)},expression:"proveedor.pais"}})],1)],1)]),o("div",{staticClass:"row mb-2"},[e._m(4),o("div",{staticClass:"col"},[o("b-collapse",{attrs:{visible:!e.proveedor.provincia&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Seleccione una provincia")])],1),o("b-overlay",{attrs:{"spinner-variant":"primary",show:e.provinciasLoading,rounded:"sm"}},[o("b-form-select",{attrs:{state:!(!e.proveedor.provincia&&e.falloInput)&&null,options:e.provincias},on:{change:e.cargarCiudadesAPI},scopedSlots:e._u([{key:"first",fn:function(){return[o("b-form-select-option",{attrs:{value:null,disabled:""}},[e._v("-- Selecciona una provincia --")])]},proxy:!0}]),model:{value:e.proveedor.provincia,callback:function(t){e.$set(e.proveedor,"provincia",t)},expression:"proveedor.provincia"}})],1)],1)]),o("div",{staticClass:"row mb-2"},[e._m(5),o("div",{staticClass:"col"},[o("b-collapse",{attrs:{visible:!e.proveedor.ciudad&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Seleccione una ciudad")])],1),o("b-overlay",{attrs:{"spinner-variant":"primary",show:e.ciudadesLoading,rounded:"sm"}},[o("b-form-select",{attrs:{state:!(!e.proveedor.ciudad&&e.falloInput)&&null,options:e.ciudades},scopedSlots:e._u([{key:"first",fn:function(){return[o("b-form-select-option",{attrs:{value:null,disabled:""}},[e._v("-- Selecciona una ciudad --")])]},proxy:!0}]),model:{value:e.proveedor.ciudad,callback:function(t){e.$set(e.proveedor,"ciudad",t)},expression:"proveedor.ciudad"}})],1)],1)]),o("div",{staticClass:"row mb-2"},[e._m(6),o("div",{staticClass:"col"},[o("b-collapse",{attrs:{visible:!e.proveedor.calle&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Ingrese calle")])],1),o("b-form-input",{attrs:{placeholder:"Ingrese calle",state:!(!e.proveedor.calle&&e.falloInput)&&null},model:{value:e.proveedor.calle,callback:function(t){e.$set(e.proveedor,"calle",t)},expression:"proveedor.calle"}})],1)]),o("div",{staticClass:"row mb-2"},[e._m(7),o("div",{staticClass:"col"},[o("b-collapse",{attrs:{visible:!e.proveedor.altura&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Ingrese altura")])],1),o("b-form-input",{attrs:{placeholder:"Ingrese altura",type:"number",state:!(!e.proveedor.altura&&e.falloInput)&&null},model:{value:e.proveedor.altura,callback:function(t){e.$set(e.proveedor,"altura",t)},expression:"proveedor.altura"}})],1)]),o("div",{staticClass:"row mb-2"},[e._m(8),o("div",{staticClass:"col"},[o("b-form-input",{attrs:{placeholder:"Ingrese piso",type:"number"},model:{value:e.proveedor.piso,callback:function(t){e.$set(e.proveedor,"piso",t)},expression:"proveedor.piso"}})],1)]),o("div",{staticClass:"row"},[e._m(9),o("div",{staticClass:"col"},[o("b-collapse",{attrs:{visible:!e.proveedor.codigoPostal&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Ingrese codigo postal")])],1),o("b-form-input",{attrs:{placeholder:"Ingrese codigo postal",type:"number",state:!(!e.proveedor.codigoPostal&&e.falloInput)&&null},model:{value:e.proveedor.codigoPostal,callback:function(t){e.$set(e.proveedor,"codigoPostal",t)},expression:"proveedor.codigoPostal"}})],1)])])])]),o("div",{staticClass:"row mb-4 mx-2"},[o("div",{staticClass:"col-4"}),o("div",{staticClass:"col px-2"},[o("b-collapse",{attrs:{visible:e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Hay problemas en los campos")])],1),o("b-button-group",[o("b-button",{attrs:{variant:"primary"},on:{click:function(t){return e.confirmar()}}},[e._v("Confirmar")]),o("b-button",{attrs:{variant:"outline-dark"},on:{click:e.cancelarAccion}},[e._v("Cancelar")])],1)],1)])])},ut=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Nombre")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Documento")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Dirección Postal")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Pais")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Provincia")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Ciudad")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Calle")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Altura")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Piso")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Codigo Postal")])])])}],gt={props:{confirmarAccion:Function,cancelarAccion:Function},data:function(){return{proveedor:{nombre:null,documento:null,pais:null,provincia:null,ciudad:null,calle:"",altura:"",piso:"",codigoPostal:""},paises:[],provincias:[],ciudades:[],paisesLoading:!1,provinciasLoading:!1,ciudadesLoading:!1,falloInput:!1}},inject:["showLoginModal","errorHandling"],methods:{confirmar:function(){var e=this.proveedor.nombre&&this.proveedor.documento&&this.proveedor.pais&&this.proveedor.provincia&&this.proveedor.ciudad&&this.proveedor.calle&&this.proveedor.altura&&this.proveedor.codigoPostal;this.falloInput=!e,this.falloInput||this.confirmarAccion&&this.confirmarAccion(this.proveedor)},cargarPaisesAPI:function(){var e=this;this.loadingPaises=!0,this.proveedor.pais=null,this.proveedor.provincia=null,this.proveedor.ciudad=null,y.get("/api/pais",{success:function(t){e.paises=t.data.map((function(e){return{value:e.clave,text:e.name}}))},notLoggedIn:function(){e.showLoginModal(!0)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.loadingPaises=!1}})},cargarProvinciasAPI:function(){var e=this;this.provinciasLoading=!0,this.proveedor.provincia=null,this.proveedor.ciudad=null;var t=this.proveedor.pais;null!=t&&y.get("/api/pais/".concat(t,"/provincia"),{success:function(t){e.provincias=t.data.map((function(e){return{value:e.clave,text:e.name}}))},notLoggedIn:function(){e.showLoginModal(!0)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.provinciasLoading=!1}})},cargarCiudadesAPI:function(){var e=this;this.proveedor.ciudad=null,this.ciudadesLoading=!0;var t=this.proveedor.pais,o=this.proveedor.provincia;null!=t&&null!=o&&y.get("/api/pais/".concat(t,"/provincia/").concat(o,"/ciudad"),{success:function(t){e.ciudades=t.data.map((function(e){return{value:e.clave,text:e.name}}))},notLoggedIn:function(){e.showLoginModal(!0)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.ciudadesLoading=!1}})}},watch:{proveedor:function(){console.log("changed")}},mounted:function(){this.cargarPaisesAPI()}},pt=gt,mt=Object(u["a"])(pt,dt,ut,!1,null,null,null),ft=mt.exports,vt={props:{itemsReadOnly:Array,buscarEgresos:Boolean,confirmarAccion:Function,cancelarAccion:Function},data:function(){return{presupuesto:{proveedor:null,egreso:null,fechaVigente:null,items:[]},cargandoProveedor:!1,proveedoresSelect:[],proveedoresLoading:!1,proveedorAAgregar:null,egresosLoading:!1,egresosSelect:[],falloInput:!1}},inject:["showLoginModal","errorHandling","createToast"],methods:{confirmar:function(){var e=this.presupuesto.proveedor&&this.presupuesto.fechaVigente&&this.presupuesto.items.length>0;this.falloInput=!e,this.falloInput||this.crearProveedorAPI()},crearProveedorAPI:function(){var e=this;if(null!=this.proveedorAAgregar)console.log("POST '/api/proveedor'"),console.log(JSON.stringify(this.proveedorAAgregar,null,4)),y.post("/api/proveedor",this.proveedorAAgregar,{success:function(t){e.createToast("Guardado exitoso","Se creó el proveedor exitosamente","success"),e.presupuesto.proveedor=t.id,void 0==e.confirmarAccion||void 0==e.cancelarAccion||e.confirmarAccion(e.presupuesto)},notLoggedIn:function(){e.showLoginModal(!0)},failed:function(t){e.createToast("Error","No se pudo crear el proveedor","danger")},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)}});else if(void 0!=this.confirmarAccion&&void 0!=this.cancelarAccion)return void this.confirmarAccion(this.presupuesto)},actualizarItems:function(e){this.presupuesto.items=e.map((function(e){return{itemEgreso:e.id,precio:e.precio}}))},confirmarProveedor:function(e){this.proveedorAAgregar=e,console.log(this.proveedorAAgregar.nombre),this.presupuesto.proveedor="nuevoProveedor",this.cargandoProveedor=!1},cancelarProveedor:function(){this.cargandoProveedor=!1},cargarProveedoresAPI:function(){var e=this;this.proveedoresLoading=!0,y.get("/api/proveedores",{success:function(t){e.proveedoresSelect=t.data.map(e.proveedoresAPIConverter)},notLoggedIn:function(){e.showLoginModal(!0)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.proveedoresLoading=!1}})},proveedoresAPIConverter:function(e){return{value:e.id,text:e.nombre}},cargarEgresosAPI:function(){var e=this;y.get("/api/operaciones/egresos",{success:function(t){e.egresosSelect=t.egresos.map(e.egresosAPIConverter)},notLoggedIn:function(){e.showLoginModal(!1)},error:function(t){e.errorHandling(t)},forbidden:function(t){e.errorHandling(t)},always:function(){e.egresosLoading=!1}})},egresosAPIConverter:function(e){return{value:e.id,text:"Egreso "+e.id,type:e}}},components:{"tabla-items":lt,"agregar-proveedor":ft},watch:{"egreso.medioDePago.id":function(e){}},mounted:function(){this.cargarProveedoresAPI()}},ht=vt,bt=Object(u["a"])(ht,ot,at,!1,null,null,null),Ct=bt.exports,_t={props:{egresoLoaded:Function},template:"{{> egreso/egresoHTML.hbs}}",data:function(){return{egreso:null,archivo:null,archivoImagenUrl:"",archivoProgress:0,showDatosProveedor:!1,showDatosFactura:!1,showIngreso:!1,showPresupuestos:!1,campos_items:[{key:"tipoItem",label:"Tipo",tdClass:[],thClass:[]},{key:"descripcion",label:"Descripcion",tdClass:["w-100"],thClass:[]},{key:"cantidad",label:"Cantidad",tdClass:["text-center"],thClass:["text-center"]},{key:"precio",label:"Precio",tdClass:[],thClass:[]}],egresoLoading:!1,falloCarga:!1,falloCargaDetalles:""}},inject:["showLoginModal","errorHandling","createToast"],methods:{convertDate:C,cargarEgresoAPI:function(){var e=this,t=this.$route.params.id;void 0!=t&&y.get("/api/operaciones/egreso/".concat(t),{success:function(t){console.log(t),e.egreso=t.egreso,e.egreso.items=t.egreso.items.map(e.itemEgresoAPIConverter),e.egreso.estaSuscrito=t.estaSuscrito,e.egreso.presupuestoElegido=t.presupuesto},notLoggedIn:function(){e.showLoginModal(!0)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.egresoLoaded()}})},itemEgresoAPIConverter:function(e){return{id:e.id,tipoItem:e.item.tipoItem.nombre,descripcion:e.item.descripcion,cantidad:e.cantidad,precio:e.precio}},confirmarAsociarIngreso:function(e){var t=this;this.falloCarga=!1,this.$bvModal.hide("modal-asociar-ingreso"),console.log(e);var o=e;if(o){this.egresoLoading=!0;var a={egresoId:this.egreso.id,ingresoId:o.id};console.log("POST '/api/operaciones/asociarManualmente'"),console.log(JSON.stringify(a,null,4)),y.post("/api/operaciones/asociarManualmente",a,{success:function(e){t.cargarEgresoAPI()},notLoggedIn:function(){t.showLoginModal(!0)},failed:function(e){t.falloCarga=!0,t.falloCargaDetalles=e.message},forbidden:function(e){t.falloCarga=!0,t.errorHandling(e)},error:function(e){t.falloCarga=!0,t.errorHandling(e)},always:function(){t.egresoLoading=!1}})}},cancelarAsociarIngreso:function(){this.$bvModal.hide("modal-asociar-ingreso")},confirmarAsociarCategorias:function(e){var t=this;this.falloCarga=!1,this.$bvModal.hide("modal-asociar-categoria"),console.log(e);var o=e;if(o){this.egresoLoading=!0;var a={id:this.egreso.id,categorias:o.map((function(e){return e.id}))};console.log("POST '/api/categorias/asociar'"),console.log(JSON.stringify(a,null,4)),y.post("/api/categorias/asociar",a,{success:function(e){t.cargarEgresoAPI()},notLoggedIn:function(){t.showLoginModal(!0)},failed:function(e){t.falloCarga=!0,t.falloAsociacionDetalles=e.message},forbidden:function(e){t.falloCarga=!0,t.errorHandling(e)},error:function(e){t.falloCarga=!0,t.errorHandling(e)},always:function(){t.egresoLoading=!1}})}},cancelarAsociarCategorias:function(){this.$bvModal.hide("modal-asociar-categoria")},confirmarNuevoPresupuesto:function(e){var t=this;this.$bvModal.hide("modal-agregar-presupuesto");var o=e;o.egreso=this.egreso.id,console.log(o),this.falloCarga=!1,y.post("/api/operaciones/presupuesto",o,{success:function(e){t.createToast("Guardado exitoso","Se creó el presupuesto exitosamente","success"),t.cargarEgresoAPI()},notLoggedIn:function(){t.showLoginModal(!0)},failed:function(e){t.falloCarga=!0,t.falloCargaDetalles=e.message},forbidden:function(e){t.falloCarga=!0,t.errorHandling(e)},error:function(e){t.falloCarga=!0,t.errorHandling(e)}})},cancelarNuevoPresupuesto:function(){this.$bvModal.hide("modal-agregar-presupuesto")},suscribirseAPI:function(){var e=this;this.egresoLoading=!0,y.post("/api/operaciones/egreso/suscribirse",{egresoId:this.egreso.id},{success:function(t){console.log(t),e.cargarEgresoAPI()},notLoggedIn:function(){e.showLoginModal(!0)},failed:function(t){e.falloCarga=!0,e.falloCargaDetalles=t.message},forbidden:function(t){e.falloCarga=!0,e.errorHandling(t)},error:function(t){e.falloCarga=!0,e.errorHandling(t)},always:function(){e.egresoLoading=!1}})},updateFileAPI:function(){var e=this;if(this.archivo){this.egresoLoading=!0;var t=new FormData;t.append(this.egreso.documento.pathAdjunto,this.archivo);var o={onUploadProgress:function(t){var o=Math.round(100*t.loaded/t.total);e.archivoProgress=o}};y.patch("/api/operaciones/documentoComercial/archivo",t,{success:function(e){console.log(e.paths.archivo)},notLoggedIn:function(t){e.showLoginModal(!1)},failed:function(e){console.log(e)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.archivoProgress=0,e.egresoLoading=!1},default:function(e){console.log("NO RESPONSE CODE"),console.log(e)}},o)}else this.createToast("No hay archivo","Elija un archivo para actualizar el Egreso","warning")},uploadFileAPI:function(e){var t=this;if(this.archivo){this.egresoLoading=!0;var o=new FormData;o.append("archivo",this.archivo);var a={onUploadProgress:function(e){var o=Math.round(100*e.loaded/e.total);t.archivoProgress=o}};y.post("/api/operaciones/documentoComercial/archivo",o,{success:function(e){console.log(e),t.updateArchivoEgresoAPI(e.paths.archivo)},notLoggedIn:function(e){t.showLoginModal(!1)},failed:function(e){console.log(e)},forbidden:function(e){t.errorHandling(e)},error:function(e){t.errorHandling(e)},always:function(){t.egresoLoading=!1},default:function(e){console.log("NO RESPONSE CODE"),console.log(e)}},a)}else this.createToast("No hay archivo","Elija un archivo para agregar al Egreso","warning")},updateArchivoEgresoAPI:function(e){var t=this,o={egreso:this.egreso.id,pathAdjuntoDocumentoComercial:e};y.patch("/api/operaciones/egreso/modificarPathAdjunto",o,{success:function(e){t.cargarEgresoAPI()},notLoggedIn:function(e){t.showLoginModal(!1)},failed:function(e){console.log(e)},forbidden:function(e){t.errorHandling(e)},error:function(e){t.errorHandling(e)},always:function(){t.egresoLoading=!1},default:function(e){console.log("NO RESPONSE CODE"),console.log(e)}})},presupuestoElegido:function(e){return e.id==this.egreso.presupuestoElegido}},mounted:function(){this.cargarEgresoAPI()},components:{"asociar-ingreso":tt,"asociar-categoria":Ye,"agregar-presupuesto":Ct}},yt=_t,xt=(o("eea0"),Object(u["a"])(yt,He,ze,!1,null,null,null)),It=xt.exports,wt={data:function(){return{egresos:[],egresoLoading:!0,egresosLoading:!1,egresoSelected:null,egresoKey:0,ingresosLoading:!1,campos_egresos:[{key:"name",label:"Egreso",thClass:["w-100"],tdClass:[],sortable:!0},{key:"validado",label:"Estado",thClass:["text-center"],tdClass:["text-center"],sortable:!0},{key:"valorTotal",label:"Total",thClass:["text-center"],tdClass:["text-center"],sortable:!0},{key:"fechaOperacion",label:"Emitido",thClass:["text-center"],tdClass:["text-center"],sortable:!0}]}},inject:["showLoginModal","errorHandling"],methods:{test:function(e){this.seleccionarEgreso(),this.egresoKey=!this.egresoKey},cargarEgresosAPI:function(e){var t=this;this.egresosLoading=!0,y.get("/api/operaciones/egresos",{success:function(e){t.egresos=e.egresos.map(t.egresosAPIConverter)},notLoggedIn:function(){t.showLoginModal(!0)},forbidden:function(e){t.errorHandling(e)},error:function(e){t.errorHandling(e)},always:function(){t.egresosLoading=!1}})},egresosAPIConverter:function(e){return{id:e.id,name:"Egreso "+e.id,validado:e.validado,valorTotal:e.montoTotal,fechaOperacion:C(e.fechaOperacion),_showDetails:!0,showEgreso:!1}},toggleEgreso:function(e){e.showEgreso?this.$router.push("/operaciones/egreso"):this.$router.push("/operaciones/egreso/"+e.id)},seleccionarEgreso:function(){var e=this.$route.params.id;this.egresoLoading=!0,this.egresos.forEach((function(t){t.id!=e?t.showEgreso=!1:t.showEgreso=!0}))},egresoLoaded:function(){this.egresoLoading=!1},egresoOpened:function(){return"egresos"==this.$route.name||"egreso"==this.$route.name},rowStyle:function(e,t){return"row"==t&&e.showEgreso?["bg-secondary","text-light"]:"row-details"==t?["bg-secondary"]:void 0}},components:{egreso:It},watch:{$route:function(e,t){"egresos"==this.$route.name&&this.cargarEgresosAPI(),this.seleccionarEgreso()},egresosLoading:function(e,t){0==e&&this.seleccionarEgreso()}},mounted:function(){this.cargarEgresosAPI(),this.seleccionarEgreso()}},Pt=wt,At=(o("c83b"),Object(u["a"])(Pt,De,Me,!1,null,null,null)),kt=At.exports,St=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"border border-top-0"},[o("b-overlay",{staticClass:"border-bottom",attrs:{variant:"primary","spinner-variant":"light",show:e.ingresosLoading}},[o("b-table",{staticClass:"mb-0 border-0 border-bottom table-row-pointer",attrs:{"show-empty":"","tbody-tr-class":e.rowStyle,"head-variant":"dark","sort-by":"name",fields:e.campos_ingresos,items:e.ingresos},on:{"row-clicked":e.toggleIngreso},scopedSlots:e._u([{key:"cell(descripcion)",fn:function(t){return[o("div",{staticClass:"text-nowrap text-truncate"},[e._v(e._s(t.item.descripcion))])]}},{key:"cell(montoTotal)",fn:function(t){return[o("span",[e._v(e._s("$"+t.item.montoTotal))])]}},{key:"row-details",fn:function(t){return[o("b-collapse",{attrs:{visible:t.item.showIngreso}},[o("div",{staticClass:"px-2 pb-2 egreso_container"},[o("b-card",{attrs:{"no-body":""}},[o("b-card-body",{staticClass:"p-2"},[t.item.egresos.length?o("div",[e._v(" Este ingreso esta asociado a "),e._l(t.item.egresos,(function(t,a){return[o("b-badge",{key:a,staticClass:"mr-2 py-1 px-2",attrs:{to:"/operaciones/egreso/"+t}},[e._v(" Egreso "+e._s(t)+" ")])]}))],2):e._e(),o("div",[e._v(" Fecha límite de egresos "),o("b-badge",{staticClass:"mr-2 py-1 px-2"},[e._v(e._s(t.item.fechaAceptacion))])],1)])],1)],1)])]}},{key:"empty",fn:function(){return[o("h4",[e._v("No hay ingresos para mostrar")])]},proxy:!0}])}),o("b-button",{staticClass:"m-2",attrs:{variant:"outline-primary",to:"/operaciones/ingreso/agregar"}},[o("b-icon-plus"),e._v(" Agregar Ingreso ")],1)],1)],1)},Et=[],Lt={data:function(){return{ingresos:[],ingresosLoading:!1,campos_ingresos:[{key:"name",label:"Ingreso",thClass:["w-25"],tdClass:[],sortable:!0},{key:"descripcion",label:"Descripcion",thClass:["w-50"],tdClass:["mw-0"]},{key:"montoTotal",label:"Total",thClass:["text-center"],tdClass:["text-center"],sortable:!0},{key:"fechaOperacion",label:"Fecha Operación",thClass:["text-center","w-25"],tdClass:["text-center"],sortable:!0}]}},inject:["showLoginModal","errorHandling"],methods:{convertDate:C,cargarIngresosAPI:function(){var e=this;this.ingresosLoading=!0,y.get("/api/operaciones/ingresos",{success:function(t){console.log(t),e.ingresos=t.ingresos.map(e.ingresosAPIConverter),console.log(e.ingresos)},notLoggedIn:function(){e.showLoginModal(!0)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.ingresosLoading=!1}})},ingresosAPIConverter:function(e){return{id:e.id,name:"Ingreso "+e.id,descripcion:e.descripcion,montoTotal:e.montoTotal,fechaOperacion:"".concat(e.fechaOperacion.day,"/").concat(e.fechaOperacion.month,"/").concat(e.fechaOperacion.year),fechaAceptacion:"".concat(e.fechaAceptacion.day,"/").concat(e.fechaAceptacion.month,"/").concat(e.fechaAceptacion.year),egresos:e.egresos,_showDetails:!0,showIngreso:!1}},toggleIngreso:function(e){this.seleccionarIngreso(e.id)},seleccionarIngreso:function(e){this.ingresos.forEach((function(t){t.id!=e?t.showIngreso=!1:t.showIngreso=!t.showIngreso}))},rowStyle:function(e,t){return"row"==t&&e.showIngreso?["bg-secondary","text-light"]:"row-details"==t?["bg-secondary"]:void 0}},mounted:function(){this.cargarIngresosAPI()}},Ot=Lt,jt=(o("4d9a"),Object(u["a"])(Ot,St,Et,!1,null,null,null)),$t=jt.exports,Dt=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("b-overlay",{staticClass:"container-fluid h-100",attrs:{"spinner-variant":"light",variant:"primary",show:e.loading},scopedSlots:e._u([{key:"overlay",fn:function(){return[o("div",{staticClass:"d-flex align-items-center"},[o("b-spinner",{staticClass:"flex-shrink-0",attrs:{variant:"light"}}),o("span",{staticClass:"text-light ml-4"},[e._v("Cargando mensajes...")])],1)]},proxy:!0}])},[o("div",{staticClass:"row h-100"},[o("div",{staticClass:"col-5 col-lg-4 col-xl-3 h-100 border-right p-0"},[o("div",{staticClass:"w-100 h-100 d-flex flex-column"},[o("div",{staticClass:"flex-shrink-0 border-bottom"},[o("div",{staticClass:"d-flex align-items-center p-1"},[o("div",{staticClass:"w-100 pl-3 text-truncate"},[e._v(e._s(e.mensajesFiltradosOrdenados.length)+" Mensajes Filtrados")]),o("b-button-group",[o("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.top",modifiers:{hover:!0,top:!0}},{name:"b-toggle",rawName:"v-b-toggle.filter-sort",modifiers:{"filter-sort":!0}}],attrs:{squared:"",variant:"outline",title:"Filtrar y Ordenar mensajes"}},[o("b-icon-sort-down")],1)],1)],1),o("b-collapse",{attrs:{id:"filter-sort"}},[o("div",{staticClass:"border-top p-3",staticStyle:{"background-color":"#eee"}},[o("b-form-group",{attrs:{label:"Ordenar por"}},[o("b-form-select",{model:{value:e.ordenar,callback:function(t){e.ordenar=t},expression:"ordenar"}},[o("b-form-select-option",{attrs:{value:null}},[e._v("Sin ordenar")]),o("b-form-select-option",{attrs:{value:"fecha",selected:""}},[e._v("Fecha")]),o("b-form-select-option",{attrs:{value:"no leidos"}},[e._v("No Leidos")])],1)],1),o("b-form-group",{staticClass:"m-0",attrs:{label:"Filtrar por"}},[o("b-form-radio",{attrs:{value:null},model:{value:e.filtrar,callback:function(t){e.filtrar=t},expression:"filtrar"}},[e._v("Ambos")]),o("b-form-radio",{attrs:{value:"leidos"},model:{value:e.filtrar,callback:function(t){e.filtrar=t},expression:"filtrar"}},[e._v("Leidos")]),o("b-form-radio",{attrs:{value:"no leidos"},model:{value:e.filtrar,callback:function(t){e.filtrar=t},expression:"filtrar"}},[e._v("No Leidos")])],1)],1)])],1),e.mensajesFiltradosOrdenados.length?o("b-list-group",{staticClass:"overflow-auto h-100 p-0",attrs:{flush:""}},e._l(e.mensajesFiltradosOrdenados,(function(t){return o("b-list-group-item",{key:t.id,staticClass:"d-flex justify-content-between align-items-center",attrs:{to:"/bandeja/"+t.id,active:t.id==e.selected}},[o("span",{staticClass:"d-inline-block text-truncate"},[e._v(e._s(t.cuerpo))]),t.leido?e._e():o("b-badge",{staticClass:"ml-1 mr-1",attrs:{pill:"",variant:"success"}},[e._v("nuevo")]),o("b-badge",{attrs:{pill:"",variant:"light"}},[e._v(e._s(e.convertDate(t.fechaCreacion)))])],1)})),1):o("div",{staticClass:"d-flex h-100 justify-content-center align-items-center"},[o("div",{staticClass:"text-secondary text-center"},[o("h1",[o("b-icon-emoji-sunglasses")],1),o("p",[e._v("La bandeja de mensajes esta vacía")])])])],1)]),o("div",{staticClass:"col overflow-auto d-flex flex-column h-100 p-0"},[o("transition",{attrs:{name:"fade",mode:"out-in"}},[e.getMessageSelected()?o("div",{key:e.selected,staticClass:"container-fluid h-100"},[o("div",{staticClass:"row"},[o("div",{staticClass:"d-flex bg-primary justify-content-between align-items-center col-12 p-3"},[o("h4",{staticClass:"text-light m-0"},[e._v("Mensaje "+e._s(e.getMessageSelected().id))]),o("b-badge",{attrs:{pill:"",variant:"primary"}},[e._v(e._s(e.convertDate(e.getMessageSelected().fechaCreacion)))])],1),o("div",{staticClass:"col p-3 text-justify"},[o("div",{staticStyle:{"white-space":"pre-wrap"}},[e._v(e._s(e.getFormattedMessageSelected().cuerpo))]),o("br"),o("router-link",{attrs:{variant:"outline-primary",size:"sm",to:"/operaciones/egreso/"+e.getFormattedMessageSelected().egresoId}},[e._v("ir al egreso")])],1)])]):o("div",{staticClass:"d-flex h-100 justify-content-center align-items-center"},[o("div",{staticClass:"text-secondary text-center"},[o("p",[e._v("Seleccione algún mensaje para verlo aquí")])])])]),o("div",{staticClass:"border-top py-4 px-3 text-secondary bg-light"},[e._v(" La validación de egresos se realiza los días "),o("strong",[e._v(e._s(e.diasFormat))]),e._v(" a las "),o("strong",[e._v(e._s(e.horaFormat)+":"+e._s(e.minutoFormat))])])],1)])])},Mt=[],Ht=(o("4de4"),o("466d"),{data:function(){return{scheduler:null,mensajes:[],mensajesFiltradosOrdenados:[],mensajesFormated:[],selected:null,loading:!0,ordenar:"fecha",filtrar:null}},inject:["errorHandling","showLoginModal"],methods:{convertDate:C,seleccionarMensaje:function(){var e=this.$route.params.id;this.selected=e,this.marcarVistoAPI()},marcarVistoAPI:function(){var e=this;if(null!=this.getMessageSelected()){this.getMessageSelected().leido=!0;var t={id:this.getMessageSelected().id};y.post("/api/bandeja/visto",t,{notLoggedIn:function(){e.showLoginModal(!0)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)}})}},cargarMensajesAPI:function(){var e=this;this.loading=!0,y.get("/api/bandeja",{success:function(t){e.mensajes=t.mensajes,e.formatMensajes(t.mensajes),e.ordenarFiltrarMensajes()},notLoggedIn:function(){e.showLoginModal(!0)},empty:function(){e.mensajes=[]},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.loading=!1}})},formatMensajes:function(e){var t=this;e.forEach((function(e){var o={},a=e.cuerpo.match(/\d+/)[0],r=e.cuerpo;o.id=e.id,o.egresoId=a,o.cuerpo=r,console.log(o),t.mensajesFormated.push(o)})),console.log(e)},getMessageSelected:function(){for(var e=null,t=0;t<this.mensajes.length;t++)this.mensajes[t].id==this.selected&&(e=this.mensajes[t]);return e},getFormattedMessageSelected:function(){for(var e=null,t=0;t<this.mensajesFormated.length;t++)this.mensajesFormated[t].id==this.selected&&(e=this.mensajesFormated[t]);return e},ordenarPorFecha:function(e,t){return e.fechaCreacion>t.fechaCreacion?-1:e.fechaCreacion<t.fechaCreacion?1:0},ordenarPorNoLeidos:function(e,t){return e.leido<t.leido?-1:e.leido>t.leido?1:0},ordenarPorId:function(e,t){return e.id<t.id?-1:e.id>t.id?1:0},filtrarSoloLeidos:function(e){return e.leido},filtrarSoloNoLeidos:function(e){return!e.leido},ordenarFiltrarMensajes:function(){var e=function(){return 1},t=this.ordenarPorId;switch(this.filtrar){case"leidos":e=this.filtrarSoloLeidos;break;case"no leidos":e=this.filtrarSoloNoLeidos;break}switch(this.ordenar){case"fecha":t=this.ordenarPorFecha;break;case"no leidos":t=this.ordenarPorNoLeidos;break}var o=this.mensajes.filter(e),a=o.sort(t);this.mensajesFiltradosOrdenados=a},cargarVinculacionConfigAPI:function(){var e=this;this.loading=!0,y.get("/api/bandeja/configuracion/1",{success:function(t){console.log(t),e.scheduler=t.schedulerInit},notLoggedIn:function(){e.showLoginModal(!0)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.loading=!1}})}},computed:{diasFormat:function(){var e="",t=["","Lunes","Martes","Miércoles","Jueves","Viernes","Sabado","Domingo"];if(this.scheduler){var o=JSON.parse(JSON.stringify(this.scheduler.dias));o.sort();for(var a=0;a<o.length;a++)0==a?e+=t[o[a]]:a<o.length-1?e+=", "+t[o[a]]:e+=" y "+t[o[a]]}return e},horaFormat:function(){var e="";return this.scheduler&&(e=("0"+this.scheduler.horaInicio).slice(-2)),e},minutoFormat:function(){var e="";return this.scheduler&&(e=("0"+this.scheduler.minutoInicio).slice(-2)),e}},watch:{$route:function(e,t){this.seleccionarMensaje()},ordenar:function(){this.ordenarFiltrarMensajes()},filtrar:function(){this.ordenarFiltrarMensajes()}},mounted:function(){this.cargarMensajesAPI(),this.cargarVinculacionConfigAPI(),this.seleccionarMensaje()}}),zt=Ht,Tt=Object(u["a"])(zt,Dt,Mt,!1,null,null,null),Ft=Tt.exports,Nt=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("b-overlay",{staticClass:"w-100 h-100",attrs:{"spinner-variant":"light",variant:"primary",show:e.loading}},[o("div",{staticClass:"p-4 d-flex justify-content-center",staticStyle:{background:"#eee","min-height":"100%"}},[o("div",{staticClass:"w-100",staticStyle:{"max-width":"768px"}},[o("b-card",{staticClass:"mb-2",attrs:{"no-body":""}},[o("b-card-body",{staticClass:"py-2"},[e._v("Datos personales")])],1),o("b-card",{staticClass:"overflow-hidden mb-4",attrs:{"no-body":""}},[o("b-row",{attrs:{"no-gutters":""}},[o("b-col",{staticClass:"d-flex justify-content-center align-items-center p-2 user-card-skew",attrs:{md:"2"}},[o("b-avatar",{attrs:{size:"5rem",variant:"secondary"}})],1),o("b-col",[o("b-card-body",{attrs:{title:e.usuario.nombre+" "+e.usuario.apellido}},[o("b-card-text",[o("div",[o("b-icon-person",{staticClass:"mr-2"}),e._v(e._s(e.usuario.username))],1),o("div",[o("b-icon-envelope",{staticClass:"mr-2"}),e._v(e._s(e.usuario.email))],1)])],1)],1)],1)],1),e.organizacion?o("b-card",{staticClass:"mb-2",attrs:{"no-body":""}},[o("b-card-body",{staticClass:"py-2"},[e._v("Organización")])],1):e._e(),e.organizacion?o("b-card",{staticClass:"overflow-hidden mb-4",attrs:{"no-body":""}},[o("b-row",{attrs:{"no-gutters":""}},[o("b-col",{staticClass:"d-flex justify-content-center align-items-center p-2 entity-card-skew",attrs:{md:"2"}},[o("b-avatar",{attrs:{size:"5rem",variant:"secondary",icon:"bar-chart-fill"}})],1),o("b-col",["Jurídica"==e.organizacion.tipo?o("b-card-body",{attrs:{title:""+e.organizacion.nombreFicticio,"sub-title":"Entidad "+e.organizacion.tipo}},[o("b-row",{staticClass:"mb-2",attrs:{"no-gutters":""}},[o("b-col",{attrs:{md:"4"}},[o("b-card-text",[o("div",{staticClass:"text-truncate"},[o("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.html",modifiers:{html:!0}}],attrs:{title:"Razon Social<br><em>"+e.organizacion.razonSocial}},[o("b-icon-card-text",{staticClass:"mr-2"}),e._v(e._s(e.organizacion.razonSocial)+" ")],1)]),o("div",{staticClass:"text-truncate"},[o("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.html",modifiers:{html:!0}}],attrs:{title:"CUIT<br><em>"+e.organizacion.cuit}},[o("b-icon-credit-card2-front",{staticClass:"mr-2"}),e._v(e._s(e.organizacion.cuit)+" ")],1)])])],1),o("b-col",{attrs:{md:"4"}},[o("b-card-text",[o("div",{staticClass:"text-truncate"},[o("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.html",modifiers:{html:!0}}],attrs:{title:"Dirección Postal<br><em>"+e.organizacionDireccionPostal}},[o("b-icon-globe",{staticClass:"mr-2"}),e._v(e._s(e.organizacionDireccionPostal)+" ")],1)]),o("div",{staticClass:"text-truncate"},[o("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.html",modifiers:{html:!0}}],attrs:{title:"Actividad<br><em>"+e.organizacion.tipoEntidadJuridica.actividad}},[o("b-icon-tools",{staticClass:"mr-2"}),e._v(e._s(e.organizacion.tipoEntidadJuridica.actividad)+" ")],1)])])],1),o("b-col",{attrs:{md:"4"}},[o("b-card-text",[o("div",{staticClass:"text-truncate"},[o("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.html",modifiers:{html:!0}}],attrs:{title:"Cantidad de personal<br><em>"+e.organizacion.tipoEntidadJuridica.cantidadDePersonal}},[o("b-icon-person-lines-fill",{staticClass:"mr-2"}),e._v(e._s(e.organizacion.tipoEntidadJuridica.cantidadDePersonal)+" ")],1)]),o("div",{staticClass:"text-truncate"},[o("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.html",modifiers:{html:!0}}],attrs:{title:"Promedio de ventas anuales<br><em>"+e.ventasAnualesFormat(e.organizacion.tipoEntidadJuridica.ventasAnuales)}},[o("b-icon-cash-stack",{staticClass:"mr-2"}),e._v(e._s(e.ventasAnualesFormat(e.organizacion.tipoEntidadJuridica.ventasAnuales))+" ")],1)])])],1)],1)],1):o("b-card-body",{attrs:{title:""+e.organizacion.nombreFicticio,"sub-title":"Entidad "+e.organizacion.tipo}})],1)],1)],1):e._e()],1)])])},Jt=[],Rt={data:function(){return{usuario:{nombre:"",apellido:"",username:"",email:""},organizacion:null,loading:!1}},inject:["showLoginModal","errorHandling","createToast"],methods:{cargarDatosAPI:function(){var e=this;this.loading=!0,y.get("/api/auth/me",{success:function(t){e.usuario.username=t.username,e.usuario.nombre=t.nombre,e.usuario.apellido=t.apellido,e.usuario.email=t.email},notLoggedIn:function(){e.showLoginModal(!0)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.loading=!1}}),y.get("/api/entidades",{success:function(t){t.organizacion.tipoEntidadJuridica?(e.organizacion=t.organizacion,e.organizacion.tipo="Jurídica"):(e.organizacion=t.organizacion,e.organizacion.tipo="Base"),console.log(t)},notLoggedIn:function(){e.showLoginModal(!0)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.loading=!1}})},ventasAnualesFormat:function(e){return"$ ".concat(e.toLocaleString())}},computed:{organizacionDireccionPostal:function(){return"\n            ".concat(this.organizacion.calle," ").concat(this.organizacion.altura,"\n            ").concat(this.organizacion.ciudad?","+this.organizacion.ciudad.name:""," \n            ").concat(this.organizacion.provincia?","+this.organizacion.provincia.name:""," \n            ").concat(this.organizacion.pais?","+this.organizacion.pais.name:"")}},mounted:function(){this.cargarDatosAPI()}},Vt=Rt,Ut=Object(u["a"])(Vt,Nt,Jt,!1,null,null,null),Bt=Ut.exports,qt=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("b-overlay",{staticClass:"w-100 h-100",attrs:{"spinner-variant":"light",variant:"primary",show:e.loading}},[o("div",{staticClass:"p-4 d-flex justify-content-center",staticStyle:{background:"#eee","min-height":"100%"}},[o("div",{staticClass:"w-100",staticStyle:{"max-width":"768px"}},[e._l(e.usuarios,(function(t,a){return[o("b-card",{key:a,staticClass:"overflow-hidden mb-4",attrs:{"no-body":""}},[o("b-row",{attrs:{"no-gutters":""}},[o("b-col",{staticClass:"d-flex justify-content-center align-items-center p-2 user-card-skew",attrs:{md:"2"}},[o("b-avatar",{attrs:{size:"5rem",variant:"secondary"}})],1),o("b-col",[o("b-card-body",{attrs:{title:t.nombre+" "+t.apellido,"sub-title":"Usuario "+t.tipo}},[o("b-card-text",[o("div",[o("b-icon-person",{staticClass:"mr-2"}),e._v(e._s(t.username))],1),o("div",[o("b-icon-bar-chart",{staticClass:"mr-2"}),o("b-link",{attrs:{to:"/admin/entidades"}},[e._v(e._s(t.entidad))])],1)])],1)],1)],1)],1)]}))],2)])])},Gt=[],Kt={data:function(){return{usuarios:[{id:1,nombre:"Alejandro",apellido:"Roco",username:"aroco",tipo:"Estandar",entidad:"Sector"},{id:2,nombre:"Rocío",apellido:"Rojas",username:"rrojas",tipo:"Estandar",entidad:"Sector"},{id:3,nombre:"Julieta",apellido:"Azul",username:"jazul",tipo:"Estandar",entidad:"Sector"}],loading:!1}},inject:["errorHandling","showLoginModal"],methods:{cargarEntidadesAPI:function(){var e=this;this.loading=!0,y.get("/api/admin/users",{success:function(t){e.usuarios=t.usuarios.map((function(e){return e.entidad=e.organizacion.nombreFicticio,e.tipo="Estandar",e})),console.log(e.usuarios)},notLoggedIn:function(){e.showLoginModal(!0)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.loading=!1}})}},mounted:function(){this.cargarEntidadesAPI()}},Yt=Kt,Qt=(o("6d21"),Object(u["a"])(Yt,qt,Gt,!1,null,null,null)),Wt=Qt.exports,Xt=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("b-overlay",{staticClass:"w-100 h-100",attrs:{"spinner-variant":"light",variant:"primary",show:e.loading}},[o("div",{staticClass:"p-4 d-flex justify-content-center",staticStyle:{background:"#eee","min-height":"100%"}},[o("div",{staticClass:"w-100",staticStyle:{"max-width":"768px"}},[e._l(e.entidades,(function(t,a){return[o("b-card",{key:a,staticClass:"overflow-hidden mb-4",attrs:{"no-body":""}},[o("b-row",{attrs:{"no-gutters":""}},[o("b-col",{staticClass:"d-flex justify-content-center align-items-center p-2 entity-card-skew",attrs:{md:"2"}},[o("b-avatar",{attrs:{size:"5rem",variant:"secondary",icon:"bar-chart-fill"}})],1),o("b-col",["Jurídica"==t.tipo?o("b-card-body",{attrs:{title:""+t.nombreFicticio,"sub-title":"Entidad "+t.tipo}},[o("b-row",{staticClass:"mb-2",attrs:{"no-gutters":""}},[o("b-col",{attrs:{md:"4"}},[o("b-card-text",{staticClass:"mr-2"},[o("div",{staticClass:"text-truncate"},[o("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.html",modifiers:{html:!0}}],attrs:{title:"Razon Social<br><em>"+t.razonSocial}},[o("b-icon-card-text",{staticClass:"mr-2"}),e._v(e._s(t.razonSocial)+" ")],1)]),o("div",{staticClass:"text-truncate"},[o("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.html",modifiers:{html:!0}}],attrs:{title:"CUIT<br><em>"+t.cuit}},[o("b-icon-credit-card2-front",{staticClass:"mr-2"}),e._v(e._s(t.cuit)+" ")],1)])])],1),o("b-col",{attrs:{md:"4"}},[o("b-card-text",{staticClass:"mr-2"},[o("div",{staticClass:"text-truncate"},[o("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.html",modifiers:{html:!0}}],attrs:{title:"Dirección Postal<br><em>"+e.organizacionDireccionPostal(t)}},[o("b-icon-globe",{staticClass:"mr-2"}),e._v(e._s(e.organizacionDireccionPostal(t))+" ")],1)]),o("div",{staticClass:"text-truncate"},[o("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.html",modifiers:{html:!0}}],attrs:{title:"Actividad<br><em>"+t.tipoEntidadJuridica.actividad}},[o("b-icon-tools",{staticClass:"mr-2"}),e._v(e._s(t.tipoEntidadJuridica.actividad)+" ")],1)])])],1),o("b-col",{attrs:{md:"4"}},[o("b-card-text",[o("div",{staticClass:"text-truncate"},[o("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.html",modifiers:{html:!0}}],attrs:{title:"Cantidad de personal<br><em>"+t.tipoEntidadJuridica.cantidadDePersonal}},[o("b-icon-person-lines-fill",{staticClass:"mr-2"}),e._v(e._s(t.tipoEntidadJuridica.cantidadDePersonal)+" ")],1)]),o("div",{staticClass:"text-truncate"},[o("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.html",modifiers:{html:!0}}],attrs:{title:"Promedio de ventas anuales<br><em>"+e.ventasAnualesFormat(t.tipoEntidadJuridica.ventasAnuales)}},[o("b-icon-cash-stack",{staticClass:"mr-2"}),e._v(e._s(e.ventasAnualesFormat(t.tipoEntidadJuridica.ventasAnuales))+" ")],1)])])],1)],1)],1):o("b-card-body",{attrs:{title:""+t.nombreFicticio,"sub-title":"Entidad "+t.tipo}})],1)],1)],1)]}))],2)])])},Zt=[],eo={data:function(){return{entidades:[],loading:!1}},inject:["errorHandling","showLoginModal"],methods:{cargarEntidadesAPI:function(){var e=this;this.loading=!0,y.get("/api/admin/entidades",{success:function(t){e.entidades=t.entidadesJuridicas.map((function(e){return e.tipo="Jurídica",e})),t.entidadesJuridicas.forEach((function(t){t.entidadesBase.forEach((function(t){t.tipo="Base",e.entidades.push(t)}))})),console.log(t)},notLoggedIn:function(){e.showLoginModal(!0)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.loading=!1}})},ventasAnualesFormat:function(e){return"$ ".concat(e.toLocaleString())},organizacionDireccionPostal:function(e){return"\n            ".concat(e.calle," ").concat(e.altura,"\n            ").concat(e.ciudad?","+e.ciudad.name:""," \n            ").concat(e.provincia?","+e.provincia.name:""," \n            ").concat(e.pais?","+e.pais.name:"")}},mounted:function(){this.cargarEntidadesAPI()}},to=eo,oo=(o("0d6c"),Object(u["a"])(to,Xt,Zt,!1,null,null,null)),ao=oo.exports,ro=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("b-overlay",{staticClass:"w-100 h-100",attrs:{"spinner-variant":"light",variant:"primary",show:e.loading}},[o("div",{staticClass:"p-4 d-flex justify-content-center",staticStyle:{background:"#eee","min-height":"100%"}},[o("div",{staticClass:"w-100",staticStyle:{"max-width":"768px"}},[o("b-card",{staticClass:"mb-4",attrs:{title:"Criterios y Categorías","sub-title":"Agregar, editar y eliminar criterios y categorías de Egresos"}},[o("ul",{staticClass:"list-group pt-2"},e._l(e.criterios,(function(t,a){return o("criterio",{key:a,attrs:{criterio:t,edit:!0,"selecciono-categoria":e.seleccionoCategoria}})})),1)])],1)])])},so=[],io={props:{confirmarAccion:Function,cancelarAccion:Function},data:function(){return{criterios:[],criteriosAPI:[],loading:!1}},inject:["showLoginModal","errorHandling"],methods:{cargarCriteriosAPI:function(){var e=this;this.loading=!0,y.get("/api/criterios",{success:function(t){e.criteriosAPI=t.criterios,e.procesarCriterios()},notLoggedIn:function(){e.showLoginModal(!0)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.loading=!1}})},procesarCriterios:function(){var e=this;this.criteriosAPI.forEach((function(t){if(t.categorias||(t.categorias=[]),t.criterios||(t.criterios=[]),t.id=t.id.toString(),t.idCriterioPadre){var o=e.criterioPorId(t.idCriterioPadre);o.criterios||(o.criterios=[]),o.criterios.push(t)}}));var t=[],o=0;for(o=0;o<this.criteriosAPI.length;o++){var a=this.criteriosAPI[o];a.idCriterioPadre&&t.push(o)}for(o=t.length-1;o>=0;o--)this.criteriosAPI.splice(t[o],1);this.criterios=this.criteriosAPI},criterioPorId:function(e){var t=null;return this.criteriosAPI.forEach((function(o){o.id==e&&(t=o)})),t},seleccionoCategoria:function(e,t){if(t)this.categoriasSeleccionadas.push(e);else{var o=this.categoriasSeleccionadas.indexOf(e);this.categoriasSeleccionadas.splice(o,1)}}},mounted:function(){this.cargarCriteriosAPI()},components:{criterio:Be}},no=io,co=Object(u["a"])(no,ro,so,!1,null,null,null),lo=co.exports,uo=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("b-overlay",{staticClass:"w-100 h-100",attrs:{"spinner-variant":"light",variant:"primary",show:e.loading}},[o("div",{staticClass:"p-4 d-flex justify-content-center",staticStyle:{background:"#eee","min-height":"100%"}},[o("div",{staticClass:"w-100",staticStyle:{"max-width":"768px"}},[o("b-card",{attrs:{title:"Vinculación automática","sub-title":"Criterios para la vinculación de Egresos e Ingresos"}},[o("b-select",{attrs:{options:e.entidadesOptions,size:"sm"},scopedSlots:e._u([{key:"first",fn:function(){return[o("b-select-option",{attrs:{disabled:"",value:null}},[e._v("--Seleccione Entidad--")])]},proxy:!0}]),model:{value:e.entidad,callback:function(t){e.entidad=t},expression:"entidad"}}),o("b-form-checkbox-group",{staticClass:"pt-2",attrs:{options:e.criterios,stacked:""},model:{value:e.criteriosSeleccionados,callback:function(t){e.criteriosSeleccionados=t},expression:"criteriosSeleccionados"}}),o("transition",{attrs:{name:"fade"}},[e.entidad?o("b-button",{staticClass:"mt-2",attrs:{variant:"primary",size:"sm"},on:{click:e.guardarConfiguracionAPI}},[e._v("Guardar Configuración")]):e._e()],1)],1)],1)])])},go=[],po={data:function(){return{criterios:[{text:"Orden por fecha",value:"Fecha"},{text:"Orden por valor (Primero Egreso)",value:"OrdenValorPrimeroEgreso"},{text:"Orden por valor (Primero Ingreso)",value:"OrdenValorPrimeroIngreso"}],entidad:null,entidadesOptions:[],criteriosSeleccionados:[],loading:!1}},inject:["showLoginModal","errorHandling","createToast"],methods:{cargarEntidadesAPI:function(){var e=this;this.loading=!0,y.get("/api/admin/entidades",{success:function(t){e.entidadesOptions=t.entidadesJuridicas.map((function(e){return{text:"".concat(e.nombreFicticio," - Entidad Jurídica"),value:e.id}})),t.entidadesJuridicas.forEach((function(t){t.entidadesBase.forEach((function(t){e.entidadesOptions.push({text:"".concat(t.nombreFicticio," - Entidad Base"),value:t.id})}))}))},notLoggedIn:function(){e.showLoginModal(!0)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.loading=!1}})},guardarConfiguracionAPI:function(){var e=this;this.loading=!0;var t={organizacionId:this.entidad,criterios:this.criteriosSeleccionados};console.log(JSON.stringify(t,null,4)),y.post("/api/admin/configurarVinculador",t,{success:function(t){e.createToast("Guardado exitoso","Se guardo la configuración correctamente","success"),console.log(t)},notLoggedIn:function(){e.showLoginModal(!0)},failed:function(e){console.log(e)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.loading=!1},default:function(e){console.log(e)}})}},mounted:function(){this.cargarEntidadesAPI()}},mo=po,fo=Object(u["a"])(mo,uo,go,!1,null,null,null),vo=fo.exports,ho=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("b-overlay",{staticClass:"w-100 h-100",attrs:{"spinner-variant":"light",variant:"primary",show:e.loading}},[o("div",{staticClass:"p-4 d-flex justify-content-center",staticStyle:{background:"#eee","min-height":"100%"}},[o("div",{staticClass:"w-100",staticStyle:{"max-width":"425px"}},[o("b-select",{attrs:{options:e.entidadesOptions},on:{change:e.cargarConfiguracionAPI},scopedSlots:e._u([{key:"first",fn:function(){return[o("b-select-option",{attrs:{disabled:"",value:null}},[e._v("--Seleccione Entidad--")])]},proxy:!0}]),model:{value:e.scheduler.entidad,callback:function(t){e.$set(e.scheduler,"entidad",t)},expression:"scheduler.entidad"}}),o("transition",{attrs:{name:"fade"}},[e.scheduler.entidad?o("div",{staticClass:"text-center"},[o("p",{staticClass:"mt-4 mb-2"},[e._v("Días en los que se ejecutará la validación de egresos")]),o("div",{staticClass:"d-flex justify-content-center"},[e._l(e.diasOptions,(function(t,a){return[o("b-button",{key:a,staticClass:"mr-1 p-0 rounded-circle text-center",staticStyle:{width:"40px",height:"40px"},attrs:{variant:e.diaIsSelected(t.value)?"primary":"outline-secondary"},on:{click:function(o){return e.toggleDia(t.value)}}},[e._v(e._s(t.text))])]}))],2),o("p",{staticClass:"mt-4 mb-2"},[e._v("Horario de inicio")]),o("div",{staticClass:"d-flex justify-content-center mb-5"},[o("div",{staticClass:"d-flex p-2 align-items-center"},[o("b-button-group",{attrs:{vertical:""}},[o("b-button",{on:{click:function(t){e.scheduler.horaInicio++}}},[o("b-icon-chevron-compact-up")],1),o("b-form-input",{staticClass:"bg-secondary text-light border-secondary rounded-0 text-center",staticStyle:{"font-size":"2rem",width:"70px"},attrs:{lazy:""},model:{value:e.scheduler.horaInicio,callback:function(t){e.$set(e.scheduler,"horaInicio",t)},expression:"scheduler.horaInicio"}}),o("b-button",{on:{click:function(t){e.scheduler.horaInicio--}}},[o("b-icon-chevron-compact-down")],1)],1),o("div",{staticClass:"p-2"},[o("b-icon-dot",{staticClass:"d-block"}),o("b-icon-dot",{staticClass:"d-block"})],1),o("b-button-group",{attrs:{vertical:""}},[o("b-button",{on:{click:function(t){e.scheduler.minutoInicio++}}},[o("b-icon-chevron-compact-up")],1),o("b-form-input",{staticClass:"bg-secondary text-light border-secondary rounded-0 text-center",staticStyle:{"font-size":"2rem",width:"70px"},attrs:{lazy:""},model:{value:e.scheduler.minutoInicio,callback:function(t){e.$set(e.scheduler,"minutoInicio",t)},expression:"scheduler.minutoInicio"}}),o("b-button",{on:{click:function(t){e.scheduler.minutoInicio--}}},[o("b-icon-chevron-compact-down")],1)],1)],1)]),o("div",{staticClass:"d-flex justify-content-center"},[o("b-button",{attrs:{variant:"primary"},on:{click:e.guardarConfiguracionAPI}},[e._v("Guardar Configuración")])],1)]):e._e()])],1)])])},bo=[],Co={data:function(){return{scheduler:{entidad:null,horaInicio:0,minutoInicio:0,dias:[]},entidadesOptions:[],diasOptions:[{value:1,text:"Lu"},{value:2,text:"Ma"},{value:3,text:"Mi"},{value:4,text:"Ju"},{value:5,text:"Vi"},{value:6,text:"Sa"},{value:7,text:"Do"}],loading:!1}},inject:["showLoginModal","errorHandling","createToast"],methods:{cargarEntidadesAPI:function(){var e=this;this.loading=!0,y.get("/api/admin/entidades",{success:function(t){e.entidadesOptions=t.entidadesJuridicas.map((function(e){return{text:"".concat(e.nombreFicticio," - Entidad Jurídica"),value:e.id}})),t.entidadesJuridicas.forEach((function(t){t.entidadesBase.forEach((function(t){e.entidadesOptions.push({text:"".concat(t.nombreFicticio," - Entidad Base"),value:t.id})}))}))},notLoggedIn:function(){e.showLoginModal(!0)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.loading=!1}})},cargarConfiguracionAPI:function(){var e=this;this.scheduler.entidad&&(this.loading=!0,y.get("/api/bandeja/configuracion/".concat(this.scheduler.entidad),{success:function(t){e.scheduler.dias=t.schedulerInit.dias,e.scheduler.horaInicio=t.schedulerInit.horaInicio,e.scheduler.minutoInicio=t.schedulerInit.minutoInicio,e.updateHoraYMinuto()},notLoggedIn:function(){e.showLoginModal(!0)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.loading=!1}}))},guardarConfiguracionAPI:function(){var e=this;this.loading=!0,this.scheduler.organizacionId=this.scheduler.entidad,console.log(this.scheduler),y.post("/api/admin/bandeja/configurar",this.scheduler,{success:function(t){e.createToast("Guardado exitoso","Se guardo la configuración correctamente","success"),e.updateHoraYMinuto()},notLoggedIn:function(){e.showLoginModal(!1)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.loading=!1}})},toggleDia:function(e){this.diaIsSelected(e)?this.scheduler.dias.splice(this.getDiaIndex(e),1):this.scheduler.dias.push(e)},diaIsSelected:function(e){return-1!=this.getDiaIndex(e)},getDiaIndex:function(e){return this.scheduler.dias.indexOf(e)},updateHoraYMinuto:function(){this.scheduler.horaInicio=("0"+this.scheduler.horaInicio).slice(-2),this.scheduler.minutoInicio=("0"+this.scheduler.minutoInicio).slice(-2)},formatHora:function(e){isNaN(e)&&(this.scheduler.horaInicio=0),e>23?this.scheduler.horaInicio=0:e<0&&(this.scheduler.horaInicio=23)},formatMinuto:function(e){isNaN(e)&&(this.scheduler.minutoInicio=0),e>59?(this.scheduler.minutoInicio=0,this.scheduler.horaInicio++):e<0&&(this.scheduler.minutoInicio=59,this.scheduler.horaInicio--)}},mounted:function(){this.cargarEntidadesAPI()},watch:{"scheduler.horaInicio":function(e){this.formatHora(e),this.updateHoraYMinuto()},"scheduler.minutoInicio":function(e){this.formatMinuto(e),this.updateHoraYMinuto()}}},_o=Co,yo=Object(u["a"])(_o,ho,bo,!1,null,null,null),xo=yo.exports,Io=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"pt-3"},[o("b-overlay",{attrs:{"spinner-variant":"light",variant:"primary",show:e.egresoLoading&&!e.falloCarga,"no-wrap":""},scopedSlots:e._u([{key:"overlay",fn:function(){return[o("div",[o("div",{staticClass:"d-flex justify-content-center"},[o("b-spinner",{staticClass:"flex-shrink-0",attrs:{variant:"light"}})],1),e.archivo?o("div",{staticClass:"mt-4"},[o("p",{staticClass:"text-light"},[e._v("Subiendo archivo")]),o("b-progress",{staticClass:"progress-min-width bg-transparent",attrs:{variant:"light",max:"100",height:"2rem"}},[o("b-progress-bar",{attrs:{value:e.archivoProgress}},[o("strong",{staticClass:"text-secondary"},[e._v(e._s(e.archivoProgress)+"%")])])],1)],1):e._e()])]},proxy:!0}])}),e._m(0),o("div",{staticClass:"row mb-4 mx-2"},[e._m(1),o("div",{staticClass:"col"},[o("b-collapse",{attrs:{visible:!e.egreso.fechaOperacion&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Ingrese la fecha de la operacion")])],1),o("b-form-datepicker",{staticClass:"mb-2",attrs:{placeholder:"Seleccione fecha de la Operación",state:!(!e.egreso.fechaOperacion&&e.falloInput)&&null},model:{value:e.egreso.fechaOperacion,callback:function(t){e.$set(e.egreso,"fechaOperacion",t)},expression:"egreso.fechaOperacion"}})],1),o("div",{staticClass:"col-lg-1 col-xl-3"})]),o("div",{staticClass:"row mb-4 mx-2 justify-content-between"},[e._m(2),o("div",{staticClass:"col d-flex align-items-end"},[o("div",{staticClass:"w-100"},[o("b-collapse",{attrs:{visible:!e.egreso.proveedor&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Seleccione un proveedor")])],1),o("b-overlay",{attrs:{"spinner-variant":"primary",show:e.proveedoresLoading,rounded:"sm"}},[o("b-form-select",{attrs:{options:e.proveedoresSelect,state:!(!e.egreso.proveedor&&e.falloInput)&&null},scopedSlots:e._u([{key:"first",fn:function(){return[o("b-form-select-option",{attrs:{value:null,disabled:""}},[e._v("-- Selecciona un Proveedor --")])]},proxy:!0}]),model:{value:e.egreso.proveedor,callback:function(t){e.$set(e.egreso,"proveedor",t)},expression:"egreso.proveedor"}},[[null!=e.proveedorAAgregar?o("b-form-select-option",{staticClass:"text-primary",attrs:{value:"nuevoProveedor"}},[e._v(e._s(e.proveedorAAgregar.nombre)+" (nuevo)")]):e._e()]],2)],1)],1)]),o("div",{staticClass:"col d-flex align-items-end"},[o("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-agregar-proveedor",modifiers:{"modal-agregar-proveedor":!0}}],attrs:{block:"",variant:"outline-primary"}},[o("b-icon-plus"),e._v(" Cargar Proveedor ")],1)],1),o("div",{staticClass:"col-lg-1 col-xl-3"})]),o("div",{staticClass:"row mb-4 mx-2 justify-content-between"},[e._m(3),o("div",{staticClass:"col d-flex align-items-end"},[o("div",{staticClass:"w-100"},[o("b-collapse",{attrs:{visible:!e.egreso.medioDePago.id&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Seleccione un medio de pago")])],1),o("b-overlay",{attrs:{"spinner-variant":"primary",show:e.mediosDePagoLoading,rounded:"sm"}},[o("b-form-select",{attrs:{options:e.mediosDePagoSelect,state:!(!e.egreso.medioDePago.id&&e.falloInput)&&null},scopedSlots:e._u([{key:"first",fn:function(){return[o("b-form-select-option",{attrs:{value:null,disabled:""}},[e._v("-- Seleccionar un Medio de Pago --")])]},proxy:!0}]),model:{value:e.egreso.medioDePago.id,callback:function(t){e.$set(e.egreso.medioDePago,"id",t)},expression:"egreso.medioDePago.id"}})],1)],1)]),o("div",{staticClass:"col d-flex align-items-end"},[o("div",{staticClass:"w-100"},[o("b-collapse",{attrs:{visible:!e.egreso.medioDePago.dato&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Ingrese el número de pago")])],1),o("b-form-input",{attrs:{placeholder:"Ingrese número de pago",state:!(!e.egreso.medioDePago.dato&&e.falloInput)&&null},model:{value:e.egreso.medioDePago.dato,callback:function(t){e.$set(e.egreso.medioDePago,"dato",t)},expression:"egreso.medioDePago.dato"}})],1)]),o("div",{staticClass:"col-lg-1 col-xl-3"})]),o("div",{staticClass:"row mb-4 mx-2"},[e._m(4),o("div",{staticClass:"col"},[o("div",{staticClass:"p-2 container-fluid border border rounded"},[o("div",{staticClass:"row mb-2"},[e._m(5),o("div",{staticClass:"col"},[o("b-collapse",{attrs:{visible:!e.egreso.documentoComercial.tipo&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Seleccione un tipo de documento")])],1),o("b-form-select",{attrs:{options:e.tipoDocumentoSelect,state:!(!e.egreso.documentoComercial.tipo&&e.falloInput)&&null},scopedSlots:e._u([{key:"first",fn:function(){return[o("b-form-select-option",{attrs:{value:null,disabled:""}},[e._v("-- Seleccionar un Tipo de Documento --")])]},proxy:!0}]),model:{value:e.egreso.documentoComercial.tipo,callback:function(t){e.$set(e.egreso.documentoComercial,"tipo",t)},expression:"egreso.documentoComercial.tipo"}})],1)]),o("div",{staticClass:"row mb-2"},[e._m(6),o("div",{staticClass:"col"},[o("b-collapse",{attrs:{visible:!e.egreso.documentoComercial.numeroDocumento&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Ingrese el número de documento")])],1),o("b-form-input",{attrs:{placeholder:"Ingrese número de documento",type:"number",state:!(!e.egreso.documentoComercial.numeroDocumento&&e.falloInput)&&null},model:{value:e.egreso.documentoComercial.numeroDocumento,callback:function(t){e.$set(e.egreso.documentoComercial,"numeroDocumento",t)},expression:"egreso.documentoComercial.numeroDocumento"}})],1)]),o("div",{staticClass:"row mb-2"},[e._m(7),o("div",{staticClass:"col"},[o("b-collapse",{attrs:{visible:!e.egreso.documentoComercial.fechaDePedido&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Ingrese la fecha de pedido")])],1),o("b-form-datepicker",{staticClass:"mb-2",attrs:{placeholder:"Seleccione fecha de Pedido",state:!(!e.egreso.documentoComercial.fechaDePedido&&e.falloInput)&&null},model:{value:e.egreso.documentoComercial.fechaDePedido,callback:function(t){e.$set(e.egreso.documentoComercial,"fechaDePedido",t)},expression:"egreso.documentoComercial.fechaDePedido"}})],1)]),o("div",{staticClass:"row mb-2"},[e._m(8),o("div",{staticClass:"col"},[o("b-collapse",{attrs:{visible:!e.egreso.documentoComercial.fechaDeEntrega&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Ingrese la fecha de entrega")])],1),o("b-form-datepicker",{staticClass:"mb-2",attrs:{placeholder:"Seleccione fecha de Entrega",state:!(!e.egreso.documentoComercial.fechaDeEntrega&&e.falloInput)&&null},model:{value:e.egreso.documentoComercial.fechaDeEntrega,callback:function(t){e.$set(e.egreso.documentoComercial,"fechaDeEntrega",t)},expression:"egreso.documentoComercial.fechaDeEntrega"}})],1)]),o("div",{staticClass:"row mb-2"},[e._m(9),o("div",{staticClass:"col"},[o("b-col",{staticClass:"px-0 mx-0"},[o("b-form-textarea",{attrs:{rows:"3","max-rows":"6",placeholder:"Breve descripción"},model:{value:e.egreso.documentoComercial.descripcion,callback:function(t){e.$set(e.egreso.documentoComercial,"descripcion",t)},expression:"egreso.documentoComercial.descripcion"}})],1)],1)]),o("div",{staticClass:"row mb-2"},[e._m(10),o("div",{staticClass:"col"},[o("b-col",{staticClass:"px-0 mx-0"},[o("b-input-group",{scopedSlots:e._u([{key:"append",fn:function(){return[o("b-button",{attrs:{variant:"outline-secondary"},on:{click:function(t){e.archivo=null}}},[o("b-icon-x")],1)]},proxy:!0}])},[o("b-form-file",{attrs:{placeholder:"Seleccione un archivo o sueltelo aqui","drop-placeholder":"Suelta el archivo aqui...","browse-text":"Buscar"},model:{value:e.archivo,callback:function(t){e.archivo=t},expression:"archivo"}})],1),o("b-collapse",{attrs:{visible:""!=e.archivoImagenUrl}},[o("b-img",{attrs:{src:e.archivoImagenUrl,fluid:""}})],1)],1)],1)])])]),o("div",{staticClass:"col-lg-1 col-xl-3"})]),o("div",{staticClass:"row mb-4 mx-2"},[e._m(11),o("div",{staticClass:"col"},[o("b-collapse",{attrs:{visible:!e.egreso.items.length&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Ingrese por lo menos un item")])],1),o("tabla-items",{attrs:{actualizarItems:e.actualizarItems}})],1),o("div",{staticClass:"col-lg-1 col-xl-3"})]),o("div",{staticClass:"row mb-4 mx-2"},[e._m(12),o("div",{staticClass:"col"},[o("div",{staticClass:"d-flex w-100 align-items-center"},[o("div",{staticClass:"p-2 w-100"},[o("b-form-checkbox",{attrs:{switch:""},on:{change:function(t){!e.requierePresupuestos&&(e.egreso.cantidadPresupuestos="")}},model:{value:e.requierePresupuestos,callback:function(t){e.requierePresupuestos=t},expression:"requierePresupuestos"}},[e._v(" Requiere presupuestos ")])],1),o("transition",{attrs:{name:"fade"}},[e.requierePresupuestos?o("b-form-input",{staticClass:"w-50",attrs:{type:"number",placeholder:"Presupuestos mínimos"},model:{value:e.egreso.cantidadPresupuestos,callback:function(t){e.$set(e.egreso,"cantidadPresupuestos",t)},expression:"egreso.cantidadPresupuestos"}}):e._e()],1)],1),e.presupuestosAAgregar.length?o("div",{staticClass:"pt-2"},[o("p",[e._v("Al egreso se le asociaran los siguientes presupuestos: ")]),o("b-table",{staticClass:"mb-0 rounded",attrs:{small:"",fields:e.presupuestosAAgregarCampos,items:e.presupuestosAAgregar},scopedSlots:e._u([{key:"cell(fechaVigente)",fn:function(t){return[e._v(" "+e._s(e.convertDate(t.item.fechaVigente))+" ")]}},{key:"cell(items)",fn:function(t){return[e._v(" "+e._s(t.item.items.length)+" ")]}},{key:"cell(delete)",fn:function(t){return[o("b-button",{staticClass:"p-0 m-0 text-danger",attrs:{variant:"outline"},on:{click:function(o){return e.removerPresupuesto(t.index)}}},[o("b-icon-x")],1)]}}],null,!1,1753986955)})],1):e._e()]),o("div",{staticClass:"col-lg-1 col-xl-3"})]),o("div",{staticClass:"row mb-4 mx-2"},[e._m(13),o("div",{staticClass:"col"},[o("b-button-group",{staticClass:"w-100"},[o("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-asociar-ingreso",modifiers:{"modal-asociar-ingreso":!0}}]},[e._v("Asociar a Ingreso")]),o("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-asociar-categoria",modifiers:{"modal-asociar-categoria":!0}}]},[e._v("Asociar a Categorías")])],1),e.ingresoAAsociar?o("div",{staticClass:"pt-2"},[e.ingresoAAsociar?o("b-collapse",{attrs:{visible:e.precioTotal()>e.ingresoAAsociar.montoRestante}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("El egreso supera el monto del ingreso")])],1):e._e(),o("span",[e._v("El egreso se asociará al siguiente ingreso: ")]),o("b-badge",[e._v(e._s(e.ingresoAAsociar.descripcion+" - $"+e.ingresoAAsociar.montoRestante+"/$"+e.ingresoAAsociar.montoTotal))])],1):e._e(),e.categoriasAAsociar.length?o("div",{staticClass:"pt-2"},[o("span",[e._v("El egreso se asociará a las siguientes categorías: ")]),e._l(e.categoriasAAsociar,(function(t,a){return[o("b-badge",{key:a,staticClass:"mr-1"},[e._v(e._s(t.name))])]}))],2):e._e()],1),o("div",{staticClass:"col-lg-1 col-xl-3"})]),o("div",{staticClass:"row mb-4 mx-2"},[e._m(14),o("div",{staticClass:"col px-2"},[o("b-form-checkbox",{staticClass:"py-2 ml-2",model:{value:e.suscribirse,callback:function(t){e.suscribirse=t},expression:"suscribirse"}},[e._v("Suscribirse a este egreso")])],1),o("div",{staticClass:"col-lg-1 col-xl-3"})]),o("div",{staticClass:"row mb-4 mx-2"},[o("div",{staticClass:"col-sm-4 col-lg-3 text-sm-right py-2"}),o("div",{staticClass:"col"},[o("b-collapse",{attrs:{visible:e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Hay problemas en los campos")])],1),o("b-collapse",{attrs:{visible:e.falloCarga}},[o("b-badge",{attrs:{variant:"danger"}},[e._v(e._s(e.falloCargaDetalles))])],1),o("b-button-group",[o("b-button",{attrs:{variant:"primary"},on:{click:e.confirmar}},[e._v("Confirmar")]),o("b-button",{attrs:{variant:"outline-dark",to:"/operaciones/egreso"}},[e._v("Cancelar")])],1)],1),o("div",{staticClass:"col-lg-1 col-xl-3"})]),o("b-modal",{attrs:{id:"modal-asociar-categoria","hide-footer":"",scrollable:"",centered:"",title:"Asociar a Categoría"}},[o("asociar-categoria",{attrs:{confirmarAccion:e.confirmarAsociarCategorias,cancelarAccion:e.cancelarAsociarCategorias}})],1),o("b-modal",{attrs:{id:"modal-asociar-ingreso","hide-footer":"",scrollable:"",centered:"",title:"Asociar a Ingreso"}},[o("asociar-ingreso",{attrs:{confirmarAccion:e.confirmarAsociarIngreso,cancelarAccion:e.cancelarAsociarIngreso}})],1),o("b-modal",{attrs:{id:"modal-agregar-proveedor",size:"xl","hide-footer":"",scrollable:"",centered:"",title:"Crear nuevo Proveedor"}},[o("agregar-proveedor",{attrs:{confirmarAccion:e.confirmarNuevoProveedor,cancelarAccion:e.cancelarNuevoProveedor}})],1),o("b-modal",{attrs:{id:"modal-agregar-presupuesto",size:"xl","hide-footer":"",scrollable:"",centered:"",title:"Crear nuevo Presupuesto"}},[o("agregar-presupuesto",{attrs:{itemsReadOnly:e.itemsReadOnlyMap(e.egreso.items),confirmarAccion:e.confirmarNuevoPresupuesto,cancelarAccion:e.cancelarNuevoPresupuesto}})],1)],1)},wo=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"row mb-4 mx-2"},[o("div",{staticClass:"col py-2 text-center"},[o("h2",[e._v("Cargar nuevo egreso")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 col-lg-3 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Fecha Operación")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 col-lg-3 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Proveedor")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 col-lg-3 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Medio de Pago")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 col-lg-3 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Documento comercial")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Tipo")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Número documento")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Fecha de Pedido")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Fecha de Entrega")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Descripción")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Archivo")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 col-lg-3 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Items")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 col-lg-3 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Presupuestos")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 col-lg-3 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Acciones")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 col-lg-3 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Suscribirse")])])])}],Po={data:function(){return{egreso:{fechaOperacion:null,proveedor:null,medioDePago:{id:null,dato:null},documentoComercial:{tipo:null,numeroDocumento:null,fechaDePedido:null,fechaDeEntrega:null,descripcion:null,nombreFicheroDocumento:null},items:[],cantidadPresupuestos:null},archivo:null,requierePresupuestos:!1,idEgreso:null,falloInput:!1,falloCarga:!1,falloCargaDetalles:"Hubo un problema al cargar el egreso",proveedoresSelect:[],mediosDePagoSelect:[],mediosDePagoType:{credit_card:[]},tipoDocumentoSelect:[{value:1,text:"Factura A"},{value:2,text:"Factura B"},{value:3,text:"Factura C"}],proveedoresLoading:!1,mediosDePagoLoading:!1,egresoLoading:!1,archivoProgress:0,suscribirse:!1,proveedorAAgregar:null,presupuestosAAgregar:[],categoriasAAsociar:[],ingresoAAsociar:null,presupuestosAAgregarCampos:[{key:"fechaVigente",tdClass:["w-50"],thClass:["w-50"]},{key:"items",tdClass:["text-center"],thClass:["text-center"]},{key:"delete",label:"",tdClass:[],thClass:["text-center"]}],archivoImagenUrl:""}},computed:{state:function(e){return console.log(e),!1}},inject:["errorHandling","createToast","showLoginModal"],watch:{archivo:function(){var e=this;if(this.archivo){if("image/png"==this.archivo.type||"image/jpeg"==this.archivo.type||"image/gif"==this.archivo.type){var t=new FileReader;t.onload=function(){var o=t.result;e.archivoImagenUrl=o},t.readAsDataURL(this.archivo)}}else this.archivoImagenUrl=""}},methods:{getCookie:_,convertDate:C,itemsReadOnlyMap:function(e){var t=JSON.parse(JSON.stringify(e));return t.map((function(e){return e.tipoItem&&(e.tipoItem=e.tipoItem.nombre),e})),t.pop(),t},confirmar:function(){this.egresoLoading=!0;var e=this.egreso.fechaOperacion&&this.egreso.proveedor&&this.egreso.medioDePago.id&&this.egreso.medioDePago.dato&&this.egreso.documentoComercial.tipo&&this.egreso.documentoComercial.numeroDocumento&&this.egreso.documentoComercial.fechaDePedido&&this.egreso.documentoComercial.fechaDeEntrega&&this.egreso.items.length>1;null!=this.ingresoAAsociar&&(e=this.precioTotal()<=this.ingresoAAsociar.montoTotal),this.falloInput=!e,this.falloInput?this.egresoLoading=!1:this.uploadFileAPI()},uploadFileAPI:function(){var e=this;if(this.archivo){var t=new FormData;t.append("archivo",this.archivo);var o={onUploadProgress:function(t){var o=Math.round(100*t.loaded/t.total);e.archivoProgress=o}};y.post("/api/operaciones/documentoComercial/archivo",t,{success:function(t){console.log(t.paths.archivo),e.egreso.documentoComercial.nombreFicheroDocumento=t.paths.archivo,e.crearProveedorAPI()},notLoggedIn:function(t){e.showLoginModal(!1)},failed:function(e){console.log(e)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.egresoLoading=!1,e.archivoProgress=0},default:function(e){console.log("NO RESPONSE CODE"),console.log(e)}},o)}else this.crearProveedorAPI()},crearProveedorAPI:function(){var e=this;null!=this.proveedorAAgregar?(console.log("POST '/api/proveedor'"),console.log(JSON.stringify(this.proveedorAAgregar,null,4)),y.post("/api/proveedor",this.proveedorAAgregar,{success:function(t){e.createToast("Guardado exitoso","Se creó el proveedor exitosamente","success"),e.egreso.proveedor=t.id,e.crearEgresoAPI()},notLoggedIn:function(){e.showLoginModal(!0)},failed:function(t){e.falloCargaDetalles=t,e.falloCarga=!0},forbidden:function(t){e.errorHandling(t),e.falloCarga=!0},error:function(t){e.errorHandling(t),e.falloCarga=!0}})):this.crearEgresoAPI()},crearEgresoAPI:function(){var e=this,t=JSON.parse(JSON.stringify(this.egreso));t.items.pop(),t.items.map((function(e){return e.tipoItem=e.tipoItem.id,e})),console.log("POST '/api/operaciones/egreso'"),console.log(JSON.stringify(t,null,4)),y.post("/api/operaciones/egreso",t,{success:function(t){e.createToast("Guardado exitoso","Se creó el egreso correctamente","success"),e.idEgreso=t.id,e.suscribirseAPI()},notLoggedIn:function(){e.showLoginModal(!0)},failed:function(t){e.falloCargaDetalles=t.message,e.falloCarga=!0},forbidden:function(t){e.errorHandling(t),e.falloCarga=!0},error:function(t){e.errorHandling(t),e.falloCarga=!0}})},suscribirseAPI:function(){var e=this;this.suscribirse?y.post("/api/operaciones/egreso/suscribirse",{egresoId:this.idEgreso},{success:function(t){console.log(t),e.asociarCategoriasAPI()},notLoggedIn:function(){e.showLoginModal(!0)},failed:function(t){e.falloCarga=!0,e.falloCargaDetalles=t.message},forbidden:function(t){e.falloCarga=!0,e.errorHandling(t)},error:function(t){e.falloCarga=!0,e.errorHandling(t)},default:function(e){console.log(e)}}):this.asociarCategoriasAPI()},asociarCategoriasAPI:function(){var e=this;if(this.categoriasAAsociar.length){var t={id:this.idEgreso,categorias:this.categoriasAAsociar.map((function(e){return e.id}))};console.log("POST '/api/categorias/asociar'"),console.log(JSON.stringify(t,null,4)),y.post("/api/categorias/asociar",t,{success:function(t){e.createToast("Guardado exitoso","Se asoció a categorías exitosamente","success"),e.asociarIngresoAPI()},notLoggedIn:function(){e.showLoginModal(!0)},failed:function(){e.falloCarga=!0},forbidden:function(t){e.errorHandling(t),e.falloCarga=!0},error:function(t){e.errorHandling(t),e.falloCarga=!0}})}else this.asociarIngresoAPI()},asociarIngresoAPI:function(){var e=this;if(this.ingresoAAsociar){var t={ingresoId:this.ingresoAAsociar.id,egresoId:this.idEgreso};console.log("POST '/api/operaciones/asociarManualmente'"),console.log(JSON.stringify(t,null,4)),y.post("/api/operaciones/asociarManualmente",t,{success:function(t){e.createToast("Guardado exitoso","Se asoció al ingreso exitosamente","success"),e.$router.push("/operaciones/egreso")},notLoggedIn:function(){e.showLoginModal(!0)},failed:function(){e.falloCarga=!0},forbidden:function(t){e.errorHandling(t),e.falloCarga=!0},error:function(t){e.errorHandling(t),e.falloCarga=!0}})}else this.$router.push("/operaciones/egreso")},cargarEntidadesAPI:function(){var e=this;this.entidadesLoading=!0,y.get("/api/entidades",{success:function(t){console.log(t),e.entidadesOptions=[{text:"".concat(t.organizacion.razonSocial," - Entidad Jurídica"),value:t.organizacion.id}],t.organizacion.entidadesBase.forEach((function(t){e.entidadesOptions.push({text:"".concat(t.nombreFicticio," - Entidad Base"),value:t.id})}))},notLoggedIn:function(){e.showLoginModal(!0)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.entidadesLoading=!1}})},cargarProveedoresAPI:function(){var e=this;this.proveedoresLoading=!0,y.get("/api/proveedores",{success:function(t){console.log(t),e.proveedoresSelect=t.data.map(e.proveedoresAPIConverter)},notLoggedIn:function(){e.showLoginModal(!0)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.proveedoresLoading=!1}})},proveedoresAPIConverter:function(e){return{value:e.id,text:e.nombre}},cargarMediosDePagoAPI:function(){var e=this;this.mediosDePagoLoading=!0,y.get("/api/medios",{success:function(t){e.mediosDePagoSelect=t.data.map(e.mediosDePagoAPIConverter)},notLoggedIn:function(){e.showLoginModal(!0)},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.mediosDePagoLoading=!1}})},mediosDePagoAPIConverter:function(e){return{value:e.id,text:e.medioDePago.charAt(0).toUpperCase()+e.medioDePago.slice(1),type:e.medioDePago}},actualizarItems:function(e){this.egreso.items=e},confirmarNuevoProveedor:function(e){this.$bvModal.hide("modal-agregar-proveedor"),this.proveedorAAgregar=e,this.egreso.proveedor="nuevoProveedor"},cancelarNuevoProveedor:function(){this.$bvModal.hide("modal-agregar-proveedor")},confirmarNuevoPresupuesto:function(e){this.$bvModal.hide("modal-agregar-presupuesto"),this.presupuestosAAgregar.push(e),console.log(e)},cancelarNuevoPresupuesto:function(){this.$bvModal.hide("modal-agregar-presupuesto")},removerPresupuesto:function(e){this.presupuestosAAgregar.splice(e,1)},confirmarAsociarCategorias:function(e){this.$bvModal.hide("modal-asociar-categoria"),this.categoriasAAsociar=e},cancelarAsociarCategorias:function(){this.$bvModal.hide("modal-asociar-categoria")},confirmarAsociarIngreso:function(e){this.$bvModal.hide("modal-asociar-ingreso"),this.ingresoAAsociar=e},cancelarAsociarIngreso:function(){this.$bvModal.hide("modal-asociar-ingreso")},precioTotal:function(){var e=0;return this.egreso.items.forEach((function(t){var o=parseFloat(t.precio),a=parseInt(t.cantidad);isNaN(o)||isNaN(a)||(e+=o*a)})),e}},mounted:function(){this.cargarProveedoresAPI(),this.cargarMediosDePagoAPI()},components:{"tabla-items":lt,"asociar-categoria":Ye,"asociar-ingreso":tt,"agregar-proveedor":ft,"agregar-presupuesto":Ct}},Ao=Po,ko=(o("f040"),Object(u["a"])(Ao,Io,wo,!1,null,null,null)),So=ko.exports,Eo=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"pt-3"},[o("b-overlay",{attrs:{"spinner-variant":"light",variant:"primary",show:e.ingresoLoading,"no-wrap":""}}),e._m(0),o("div",{staticClass:"row mb-4 mx-2"},[e._m(1),o("div",{staticClass:"col"},[o("b-collapse",{attrs:{visible:!e.ingreso.descripcion&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Ingrese una descripcion para poder identificar el ingreso")])],1),o("b-form-textarea",{attrs:{rows:"3","max-rows":"6",placeholder:"Breve descripción",state:!(!e.ingreso.descripcion&&e.falloInput)&&null},model:{value:e.ingreso.descripcion,callback:function(t){e.$set(e.ingreso,"descripcion",t)},expression:"ingreso.descripcion"}})],1),o("div",{staticClass:"col-lg-1 col-xl-3"})]),o("div",{staticClass:"row mb-4 mx-2"},[e._m(2),o("div",{staticClass:"col"},[o("b-collapse",{attrs:{visible:!e.ingreso.fechaOperacion&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Ingrese la fecha de la operacion")])],1),o("b-form-datepicker",{staticClass:"mb-2",attrs:{placeholder:"Seleccione fecha de la Operación",state:!(!e.ingreso.fechaOperacion&&e.falloInput)&&null},model:{value:e.ingreso.fechaOperacion,callback:function(t){e.$set(e.ingreso,"fechaOperacion",t)},expression:"ingreso.fechaOperacion"}})],1),o("div",{staticClass:"col-lg-1 col-xl-3"})]),o("div",{staticClass:"row mb-4 mx-2"},[e._m(3),o("div",{staticClass:"col"},[o("b-collapse",{attrs:{visible:!e.ingreso.fechaAceptacionEgresos&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Ingrese fecha límite")])],1),o("b-form-datepicker",{staticClass:"mb-2",attrs:{placeholder:"Seleccione fecha de la Operación",state:!(!e.ingreso.fechaAceptacionEgresos&&e.falloInput)&&null},model:{value:e.ingreso.fechaAceptacionEgresos,callback:function(t){e.$set(e.ingreso,"fechaAceptacionEgresos",t)},expression:"ingreso.fechaAceptacionEgresos"}})],1),o("div",{staticClass:"col-lg-1 col-xl-3"})]),o("div",{staticClass:"row mb-4 mx-2"},[e._m(4),o("div",{staticClass:"col"},[o("b-collapse",{attrs:{visible:!e.ingreso.montoTotal&&e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Ingrese el monto total")])],1),o("b-input-group",{attrs:{prepend:"$"}},[o("b-form-input",{attrs:{placeholder:"Ingrese monto total",type:"number",state:!(!e.ingreso.montoTotal&&e.falloInput)&&null},model:{value:e.ingreso.montoTotal,callback:function(t){e.$set(e.ingreso,"montoTotal",t)},expression:"ingreso.montoTotal"}})],1)],1),o("div",{staticClass:"col-lg-1 col-xl-3"})]),o("div",{staticClass:"row mb-4 mx-2"},[o("div",{staticClass:"col-sm-4 col-lg-3 text-sm-right py-2"}),o("div",{staticClass:"col"},[o("b-collapse",{attrs:{visible:e.falloInput}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Hay problemas en los campos")])],1),o("b-collapse",{attrs:{visible:e.falloCargarIngreso}},[o("b-badge",{attrs:{variant:"danger"}},[e._v("Hubo un problema al cargar el ingreso")])],1),o("b-button-group",[o("b-button",{attrs:{variant:"primary"},on:{click:e.confirmar}},[e._v("Confirmar")]),o("b-button",{attrs:{variant:"outline-dark",to:"/operaciones/ingreso"}},[e._v("Cancelar")])],1)],1),o("div",{staticClass:"col-lg-1 col-xl-3"})])],1)},Lo=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"row mb-4 mx-2"},[o("div",{staticClass:"col py-2 text-center"},[o("h2",[e._v("Cargar nuevo ingreso")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 col-lg-3 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Descripción")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 col-lg-3 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Fecha Operación")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 col-lg-3 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Fecha límite de aceptabilidad de egresos")])])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"col-sm-4 col-lg-3 text-sm-right py-2"},[o("span",{staticClass:"mr-2"},[o("strong",[e._v("Monto Total")])])])}],Oo={data:function(){return{ingreso:{fechaOperacion:null,fechaAceptacionEgresos:null,descripcion:null,montoTotal:null},falloInput:!1,falloCargarIngreso:!1,ingresoLoading:!1}},inject:["errorHandling","createToast","showLoginModal"],methods:{getCookie:_,confirmar:function(){var e=this,t=this.ingreso.fechaOperacion&&this.ingreso.fechaAceptacionEgresos&&this.ingreso.montoTotal;if(this.falloInput=!t,!this.falloInput){this.ingresoLoading=!0,this.falloCargarIngreso=!1;var o=JSON.parse(JSON.stringify(this.ingreso));console.log("POST '/api/operaciones/ingreso'"),console.log(JSON.stringify(o,null,4)),y.post("/api/operaciones/ingreso",o,{success:function(t){e.createToast("Guardado exitoso","Se dio de alta el ingreso correctamente","success"),e.$router.push("/operaciones/ingreso")},notLoggedIn:function(){e.showLoginModal(!0)},failed:function(){e.falloCargarIngreso=!0},forbidden:function(t){e.errorHandling(t)},error:function(t){e.errorHandling(t)},always:function(){e.ingresoLoading=!1}})}}}},jo=Oo,$o=Object(u["a"])(jo,Eo,Lo,!1,null,null,null),Do=$o.exports,Mo=[{name:"panel",path:"/",component:W,props:{sidebar:[{text:"Operaciones",icon:"journal-check",to:"/operaciones"},{text:"Bandeja de Mensajes",icon:"chat-left-text",to:"/bandeja",bandeja:!0},{text:"Mi Cuenta",icon:"person",to:"/cuenta"}]},children:[{name:"index",path:"",component:ke},{name:"agregarEgreso",path:"operaciones/egreso/agregar",component:So,meta:{breadcrumb:[{label:"Operaciones",type:"fixed",path:"/operaciones"},{label:"Egresos",type:"fixed",path:"/operaciones/egreso"},{label:"Agregar",type:"fixed",path:"/operaciones/egreso/agregar",active:!0}]}},{name:"agregarIngreso",path:"operaciones/ingreso/agregar",component:Do,meta:{breadcrumb:[{label:"Operaciones",type:"fixed",path:"/operaciones"},{label:"Ingresos",type:"fixed",path:"/operaciones/ingreso"},{label:"Agregar",type:"fixed",path:"/operaciones/ingreso/agregar",active:!0}]}},{name:"operaciones",path:"operaciones",component:$e,meta:{breadcrumb:[{label:"Operaciones",type:"fixed",path:"/operaciones",active:!0}]},children:[{name:"egresos",path:"egreso",component:kt,meta:{breadcrumb:[{label:"Operaciones",type:"fixed",path:"/operaciones"},{label:"Egresos",type:"fixed",path:"/operaciones/egreso",active:!0}]},children:[{name:"egreso",path:":id",component:kt,meta:{breadcrumb:[{label:"Operaciones",type:"fixed",path:"/operaciones"},{label:"Egresos",type:"fixed",path:"/operaciones/egreso"},{label:"id",type:"dynamic",dynamicText:"id",path:"/operaciones/egreso/id",active:!0}]}}]},{name:"ingresos",path:"ingreso",component:$t,meta:{breadcrumb:[{label:"Operaciones",type:"fixed",path:"/operaciones"},{label:"Ingresos",type:"fixed",path:"/operaciones/ingreso",active:!0}]}}]},{name:"bandeja",path:"bandeja",component:Ft,meta:{breadcrumb:[{label:"Bandeja de Mensajes",type:"fixed",path:"/bandeja",active:!0}]},children:[{name:"mensaje",path:":id",component:Ft,meta:{breadcrumb:[{label:"Bandeja de Mensajes",type:"fixed",path:"/bandeja"},{label:"Mensaje id",type:"dynamic",dynamicText:"id",path:"/bandeja/id",active:!0}]}}]},{name:"cuenta",path:"cuenta",component:Bt,meta:{breadcrumb:[{label:"Mi Cuenta",type:"fixed",path:"/cuenta",active:!0}]}}]},{name:"adminPanel",path:"/admin",component:W,props:{sidebar:[{text:"Usuarios",icon:"person-lines-fill",to:"/admin/usuarios"},{text:"Entidades",icon:"bar-chart-fill",to:"/admin/entidades"},{text:"Criterios",icon:"ui-checks",to:"/admin/criterios"},{text:"Vinculación automática",icon:"gear-wide-connected",to:"/admin/vinculacion"},{text:"Validación de Egresos",icon:"clock",to:"/admin/validaciones"},{text:"Mi Cuenta",icon:"person",to:"/admin/cuenta"}]},children:[{name:"configUsuarios",path:"usuarios",component:Wt,meta:{breadcrumb:[{label:"Usuarios",type:"fixed",path:"/admin/usuarios",active:!0}]}},{name:"configEntidades",path:"entidades",component:ao,meta:{breadcrumb:[{label:"Entidades",type:"fixed",path:"/admin/entidades",active:!0}]}},{name:"configCriterios",path:"criterios",component:lo,meta:{breadcrumb:[{label:"Criterios",type:"fixed",path:"/admin/criterios",active:!0}]}},{name:"configVinculacion",path:"vinculacion",component:vo,meta:{breadcrumb:[{label:"Vinculación automática",type:"fixed",path:"/admin/vinculacion",active:!0}]}},{name:"configValidacion",path:"validaciones",component:xo,meta:{breadcrumb:[{label:"Validación de Egresos",type:"fixed",path:"/admin/validaciones",active:!0}]}},{name:"adminCuenta",path:"cuenta",component:Bt,meta:{breadcrumb:[{label:"Mi Cuenta",type:"fixed",path:"/cuenta",active:!0}]}}]},{name:"login",path:"/login",component:ae},{name:"notFound",path:"/*",component:le},{name:"unauthorized",path:"",component:fe},{name:"serverError",path:"",component:ye}],Ho=new r["a"]({routes:Mo,mode:"history"});Ho.beforeEach((function(e,t,o){if("unauthorized"!=e.name&&"notFound"!=e.name&&"serverError"!=e.name&&"login"!=e.name){var a=sessionStorage.getItem("token"),r=null;if(a){r=Object(b["a"])(a);var s=e.matched[0].name,i=null;t.matched.length&&(i=t.matched[0].name),s==i||n(s,r)?o():o({name:"unauthorized"})}else o("/login")}else o();function n(e,t){return"panel"==e&&"Estandar"==t.rol||"adminPanel"==e&&"Administrador"==t.rol}}));var zo=Ho;a["default"].use(s["a"]),a["default"].use(i["a"]),a["default"].use(r["a"]),a["default"].config.productionTip=!1,new a["default"]({el:"#app",router:zo,render:function(e){return e(p)}})},"929a":function(e,t,o){e.exports=o.p+"img/utn_logo.cde9f232.png"},"9a12":function(e,t,o){},"9fb3":function(e,t,o){},b9de:function(e,t,o){},c69b:function(e,t,o){},c83b:function(e,t,o){"use strict";o("ff92")},cb73:function(e,t,o){"use strict";o("c69b")},d051:function(e,t,o){},d2b5:function(e,t,o){"use strict";o("8d27")},eea0:function(e,t,o){"use strict";o("7429")},f040:function(e,t,o){"use strict";o("1ffb")},ff92:function(e,t,o){}});
//# sourceMappingURL=index.d3b347c4.js.map